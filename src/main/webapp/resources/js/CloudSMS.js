CHECK_CHARS = "가각간갇갈갉갊감갑값갓갔강갖갗같갚갛개객갠갤갬갭갯갰갱갸갹갼걀걋걍걔걘걜거걱건걷걸걺검겁것겄겅겆겉겊겋게겐겔겜겝겟겠겡겨격겪견겯결겸겹겻겼경곁계곈곌곕곗고곡곤곧골곪곬곯곰곱곳공곶과곽관괄괆괌괍괏광괘괜괠괩괬괭괴괵괸괼굄굅굇굉교굔굘굡굣구국군굳굴굵굶굻굼굽굿궁궂궈궉권궐궜궝궤궷귀귁귄귈귐귑귓규균귤그극근귿글긁금급긋긍긔기긱긴긷길긺김깁깃깅깆깊까깍깎깐깔깖깜깝깟깠깡깥깨깩깬깰깸깹깻깼깽꺄꺅꺌꺼꺽꺾껀껄껌껍껏껐껑께껙껜껨껫껭껴껸껼꼇꼈꼍꼐꼬꼭꼰꼲꼴꼼꼽꼿꽁꽂꽃꽈꽉꽐꽜꽝꽤꽥꽹꾀꾄꾈꾐꾑꾕꾜꾸꾹꾼꿀꿇꿈꿉꿋꿍꿎꿔꿜꿨꿩꿰꿱꿴꿸뀀뀁뀄뀌뀐뀔뀜뀝뀨끄끅끈끊끌끎끓끔끕끗끙끝끼끽낀낄낌낍낏낑나낙낚난낟날낡낢남납낫났낭낮낯낱낳내낵낸낼냄냅냇냈냉냐냑냔냘냠냥너넉넋넌널넒넓넘넙넛넜넝넣네넥넨넬넴넵넷넸넹녀녁년녈념녑녔녕녘녜녠노녹논놀놂놈놉놋농높놓놔놘놜놨뇌뇐뇔뇜뇝뇟뇨뇩뇬뇰뇹뇻뇽누눅눈눋눌눔눕눗눙눠눴눼뉘뉜뉠뉨뉩뉴뉵뉼늄늅늉느늑는늘늙늚늠늡늣능늦늪늬늰늴니닉닌닐닒님닙닛닝닢다닥닦단닫달닭닮닯닳담답닷닸당닺닻닿대댁댄댈댐댑댓댔댕댜더덕덖던덛덜덞덟덤덥덧덩덫덮데덱덴델뎀뎁뎃뎄뎅뎌뎐뎔뎠뎡뎨뎬도독돈돋돌돎돐돔돕돗동돛돝돠돤돨돼됐되된될됨됩됫됴두둑둔둘둠둡둣둥둬뒀뒈뒝뒤뒨뒬뒵뒷뒹듀듄듈듐듕드득든듣들듦듬듭듯등듸디딕딘딛딜딤딥딧딨딩딪따딱딴딸땀땁땃땄땅땋때땍땐땔땜땝땟땠땡떠떡떤떨떪떫떰떱떳떴떵떻떼떽뗀뗄뗌뗍뗏뗐뗑뗘뗬또똑똔똘똥똬똴뙈뙤뙨뚜뚝뚠뚤뚫뚬뚱뛔뛰뛴뛸뜀뜁뜅뜨뜩뜬뜯뜰뜸뜹뜻띄띈띌띔띕띠띤띨띰띱띳띵라락란랄람랍랏랐랑랒랖랗래랙랜랠램랩랫랬랭랴략랸럇량러럭런럴럼럽럿렀렁렇레렉렌렐렘렙렛렝려력련렬렴렵렷렸령례롄롑롓로록론롤롬롭롯롱롸롼뢍뢨뢰뢴뢸룀룁룃룅료룐룔룝룟룡루룩룬룰룸룹룻룽뤄뤘뤠뤼뤽륀륄륌륏륑류륙륜률륨륩륫륭르륵른를름릅릇릉릊릍릎리릭린릴림립릿링마막만많맏말맑맒맘맙맛망맞맡맣매맥맨맬맴맵맷맸맹맺먀먁먈먕머먹먼멀멂멈멉멋멍멎멓메멕멘멜멤멥멧멨멩며멱면멸몃몄명몇몌모목몫몬몰몲몸몹못몽뫄뫈뫘뫙뫼묀묄묍묏묑묘묜묠묩묫무묵묶문묻물묽묾뭄뭅뭇뭉뭍뭏뭐뭔뭘뭡뭣뭬뮈뮌뮐뮤뮨뮬뮴뮷므믄믈믐믓미믹민믿밀밂밈밉밋밌밍및밑바박밖밗반받발밝밞밟밤밥밧방밭배백밴밸뱀뱁뱃뱄뱅뱉뱌뱍뱐뱝버벅번벋벌벎범법벗벙벚베벡벤벧벨벰벱벳벴벵벼벽변별볍볏볐병볕볘볜보복볶본볼봄봅봇봉봐봔봤봬뵀뵈뵉뵌뵐뵘뵙뵤뵨부북분붇불붉붊붐붑붓붕붙붚붜붤붰붸뷔뷕뷘뷜뷩뷰뷴뷸븀븃븅브븍븐블븜븝븟비빅빈빌빎빔빕빗빙빚빛빠빡빤빨빪빰빱빳빴빵빻빼빽뺀뺄뺌뺍뺏뺐뺑뺘뺙뺨뻐뻑뻔뻗뻘뻠뻣뻤뻥뻬뼁뼈뼉뼘뼙뼛뼜뼝뽀뽁뽄뽈뽐뽑뽕뾔뾰뿅뿌뿍뿐뿔뿜뿟뿡쀼쁑쁘쁜쁠쁨쁩삐삑삔삘삠삡삣삥사삭삯산삳살삵삶삼삽삿샀상샅새색샌샐샘샙샛샜생샤샥샨샬샴샵샷샹섀섄섈섐섕서석섞섟선섣설섦섧섬섭섯섰성섶세섹센셀셈셉셋셌셍셔셕션셜셤셥셧셨셩셰셴셸솅소속솎손솔솖솜솝솟송솥솨솩솬솰솽쇄쇈쇌쇔쇗쇘쇠쇤쇨쇰쇱쇳쇼쇽숀숄숌숍숏숑수숙순숟술숨숩숫숭숯숱숲숴쉈쉐쉑쉔쉘쉠쉥쉬쉭쉰쉴쉼쉽쉿슁슈슉슐슘슛슝스슥슨슬슭슴습슷승시식신싣실싫심십싯싱싶싸싹싻싼쌀쌈쌉쌌쌍쌓쌔쌕쌘쌜쌤쌥쌨쌩썅써썩썬썰썲썸썹썼썽쎄쎈쎌쏀쏘쏙쏜쏟쏠쏢쏨쏩쏭쏴쏵쏸쐈쐐쐤쐬쐰쐴쐼쐽쑈쑤쑥쑨쑬쑴쑵쑹쒀쒔쒜쒸쒼쓩쓰쓱쓴쓸쓺쓿씀씁씌씐씔씜씨씩씬씰씸씹씻씽아악안앉않알앍앎앓암압앗았앙앝앞애액앤앨앰앱앳앴앵야약얀얄얇얌얍얏양얕얗얘얜얠얩어억언얹얻얼얽얾엄업없엇었엉엊엌엎에엑엔엘엠엡엣엥여역엮연열엶엷염엽엾엿였영옅옆옇예옌옐옘옙옛옜오옥온올옭옮옰옳옴옵옷옹옻와왁완왈왐왑왓왔왕왜왝왠왬왯왱외왹왼욀욈욉욋욍요욕욘욜욤욥욧용우욱운울욹욺움웁웃웅워웍원월웜웝웠웡웨웩웬웰웸웹웽위윅윈윌윔윕윗윙유육윤율윰윱윳융윷으윽은을읊음읍읏응읒읓읔읕읖읗의읜읠읨읫이익인일읽읾잃임입잇있잉잊잎자작잔잖잗잘잚잠잡잣잤장잦재잭잰잴잼잽잿쟀쟁쟈쟉쟌쟎쟐쟘쟝쟤쟨쟬저적전절젊점접젓정젖제젝젠젤젬젭젯젱져젼졀졈졉졌졍졔조족존졸졺좀좁좃종좆좇좋좌좍좔좝좟좡좨좼좽죄죈죌죔죕죗죙죠죡죤죵주죽준줄줅줆줌줍줏중줘줬줴쥐쥑쥔쥘쥠쥡쥣쥬쥰쥴쥼즈즉즌즐즘즙즛증지직진짇질짊짐집짓징짖짙짚짜짝짠짢짤짧짬짭짯짰짱째짹짼쨀쨈쨉쨋쨌쨍쨔쨘쨩쩌쩍쩐쩔쩜쩝쩟쩠쩡쩨쩽쪄쪘쪼쪽쫀쫄쫌쫍쫏쫑쫓쫘쫙쫠쫬쫴쬈쬐쬔쬘쬠쬡쭁쭈쭉쭌쭐쭘쭙쭝쭤쭸쭹쮜쮸쯔쯤쯧쯩찌찍찐찔찜찝찡찢찧차착찬찮찰참찹찻찼창찾채책챈챌챔챕챗챘챙챠챤챦챨챰챵처척천철첨첩첫첬청체첵첸첼쳄쳅쳇쳉쳐쳔쳤쳬쳰촁초촉촌촐촘촙촛총촤촨촬촹최쵠쵤쵬쵭쵯쵱쵸춈추축춘출춤춥춧충춰췄췌췐취췬췰췸췹췻췽츄츈츌츔츙츠측츤츨츰츱츳층치칙친칟칠칡침칩칫칭카칵칸칼캄캅캇캉캐캑캔캘캠캡캣캤캥캬캭컁커컥컨컫컬컴컵컷컸컹케켁켄켈켐켑켓켕켜켠켤켬켭켯켰켱켸코콕콘콜콤콥콧콩콰콱콴콸쾀쾅쾌쾡쾨쾰쿄쿠쿡쿤쿨쿰쿱쿳쿵쿼퀀퀄퀑퀘퀭퀴퀵퀸퀼큄큅큇큉큐큔큘큠크큭큰클큼큽킁키킥킨킬킴킵킷킹타탁탄탈탉탐탑탓탔탕태택탠탤탬탭탯탰탱탸턍터턱턴털턺텀텁텃텄텅테텍텐텔템텝텟텡텨텬텼톄톈토톡톤톨톰톱톳통톺톼퇀퇘퇴퇸툇툉툐투툭툰툴툼툽툿퉁퉈퉜퉤튀튁튄튈튐튑튕튜튠튤튬튱트특튼튿틀틂틈틉틋틔틘틜틤틥티틱틴틸팀팁팃팅파팍팎판팔팖팜팝팟팠팡팥패팩팬팰팸팹팻팼팽퍄퍅퍼퍽펀펄펌펍펏펐펑페펙펜펠펨펩펫펭펴편펼폄폅폈평폐폘폡폣포폭폰폴폼폽폿퐁퐈퐝푀푄표푠푤푭푯푸푹푼푿풀풂품풉풋풍풔풩퓌퓐퓔퓜퓟퓨퓬퓰퓸퓻퓽프픈플픔픕픗피픽핀필핌핍핏핑하학한할핥함합핫항해핵핸핼햄햅햇했행햐향허헉헌헐헒험헙헛헝헤헥헨헬헴헵헷헹혀혁현혈혐협혓혔형혜혠혤혭호혹혼홀홅홈홉홋홍홑화확환활홧황홰홱홴횃횅회획횐횔횝횟횡효횬횰횹횻후훅훈훌훑훔훗훙훠훤훨훰훵훼훽휀휄휑휘휙휜휠휨휩휫휭휴휵휸휼흄흇흉흐흑흔흖흗흘흙흠흡흣흥흩희흰흴흼흽힁히힉힌힐힘힙힛힝";
CHECK_CHARS += "　！'，．／：；？＾＿｀｜￣、。·‥…¨〃­―∥＼～´?ˇ˘˝˚˙¸˛¡¿ː＂（）［］｛｝‘’“”〔〕〈〉《》「」『』【】+－＜=＞±×÷≠≤≥∞∴♂♀∠⊥⌒∂∇≡≒≪≫√∽∝∵∫∬∈∋⊆⊇⊂⊃∪∩∧∨￢⇒⇔∀∃∮∑∏＄％￦Ｆ′″℃Å￠￡￥¤℉‰㎕㎖㎗ℓ㎘㏄㎣㎤㎥㎦㎙㎚㎛㎜㎝㎞㎟㎠㎡㎢㏊㎍㎎㎏㏏㎈㎉㏈㎧㎨㎰㎱㎳㎴㎵㎶㎷㎸㎹㎀㎁㎂㎃㎄㎺㎻㎼㎽㎾㎿㎐㎑㎒㎓㎔Ω㏀㏁㎊㎋㎌㏖㏅㎭㎭㎮㎯㏛㎩㎪㎫㎬㏝㏐㏓㏃㏉㏜㏆＃＆＊＠■※☆★○●◎◇◆□■△▲▽▼→←↑↓↔〓◁◀▷▶♤♠♡♥♧♣⊙◈▣◐◑▒▤▥▨▧▦▩♨☏☎☜☞■†‡↕↗↙↖↘♭♩♪♬㉿㈜№㏇™㏂㏘℡■■─│┌┐┘└├┬┤┴┼━┃┏┓┛┗┣┳┫┻╋┠┯┨┷┿┝┰┥┸╂┒┑┚┙┖┕┎┍┞┟┡┢┦┧┩┪┭┮┱┲┵┶┹┺┽┾╀╁╃╄╅╆╇╈╉╊㉠㉡㉢㉣㉤㉥㉦㉧㉨㉩㉪㉫㉬㉭㉮㉯㉱㉲㉳㉴㉵㉶㉷㉸㉹㉺㉻㈀㈁㈂㈃㈄㈅㈆㈇㈈㈉㈊㈋㈌㈍㈎㈏㈐㈑㈒㈓㈔㈕㈖㈗㈘㈙㈚㈛ⓐⓑⓒⓓⓔⓕⓖⓗⓘⓙⓚⓛⓜⓝⓞⓟⓠⓡⓢⓣⓤⓥⓦⓧⓨⓩ①②③④⑤⑥⑦⑧⑨⑩⑪⑫⑬⑭⑮⒜⒝⒞⒟⒠⒡⒢⒣⒤⒥⒦⒧⒨⒩⒪⒫⒬⒭⒮⒯⒰⒱⒲⒳⑻⒵⑴⑵⑶⑷⑸⑹⑺⒴⑼⑽⑾⑿⒀⒁⒂ⅰⅱⅲⅳⅴⅵⅶⅷⅸⅹⅠⅡⅢⅣⅤⅥⅦⅧⅨⅩ½⅔⅔¼¾⅛⅜⅝⅞¹²³⁴ⁿ₁₂₃₄ㄱㄲㄳㄴㄵㄶㄷㄸㄹㄺㄻㄼㄽㄾㄿㅀㅁㅂㅃㅄㅅㅆㅇㅈㅉㅊㅋㅌㅍㅎㅏㅐㅑㅒㅓㅔㅕㅖㅗㅘㅙㅚㅛㅜㅝㅞㅟㅠㅡㅢㅣㅥㅦㅧㅨㅩㅪㅫㅬㅭㅮㅯㅰㅱㅲㅳㅴㅵㅶㅷㅸㅹㅺㅻㅼㅽㅾㅿㆀㆁㆂㆃㆄㆅㆆㆇㆈㆉㆊㆋㆌㆍㆎＡＢＣＤＥＦＧＨＩＪＫＬＭＮＯＰＱＲＳＴＵＶＷＸＹＺａｂｃｄｅｆｇｈｉｊｋｌｍｎｏｐｑｒｓｔｕｖｗｘｙｚㅍΑΒΓΔΕΖΗΘΙΚΛΜΝΞΟΠΡΣΤΥΦΧΨΩαβγδεζηθικλμνξοπρστυφχψω";
CHECK_CHARS += "ㄱㄲㄴㄷㄸㄹㅁㅂㅃㅅㅆㅇㅈㅉㅊㅋㅌㅍㅎ";
CHECK_CHARS += "ㅏㅑㅓㅕㅗㅛㅜㅠㅡㅣ";
CHECK_CHARS += "ァィゥェォアイウエオカキクケコガギグゲゴサシスセソザジズゼゾタチッツテトダヂヅデドナニヌネノハヒフヘホバビブベボパピプペポマミムメモャヤュユョヨラリルレロヮワヰヱヲンヴヵヶ";
CHECK_CHARS += "ぁぃぅぇぉあいうえおかきくけこがぎぐげごさしすせそざじずぜぞたちっつてとだぢづでどなにぬねのはひふへほばびぶべぼぱぴぷぺぽまみむめもゃやゅゆょよらりるれろゎわゐゑをん";

var sTop = document.all;
var InitMsg = "메시지를 입력하세요.";
var LMSInitMsg = "         [메시지입력창]";
var TempMsg = "%20%20%20%5B%uBA54%uC2DC%uC9C0%uC785%uB825%uCC3D%5D";
var LMSTempMsg = "%20%20%20%20%20%20%20%20%20%5B%uBA54%uC2DC%uC9C0%uC785%uB825%uCC3D%5D";

function is_valid_callback(callback) {
    var t = callback;
    if ((t.match(/^(02|0[3-6]\d|01(0|1|3|5|6|7|8|9)|070|080|007)\-?\d{3,4}\-?\d{4,5}$/) == null) && (t.match(/^(15|16|18)\d{2}\-?\d{4}$/) == null)) {
        return 0;
    }
    else {
        return 1;
    }
}

function IsMobileNo(s)
{
    var isMobile = /^(010|011|016|017|018|019)\-?\d{3,4}\-?\d{4}$/;
    if(s.search(isMobile)) return false; 
    return true;
}

//2015.10.13 수정함.. 
function IsCallbackNo(s) {
    var isCollbackNo = /^[-0-9]+$/;
    if (s.search(isCollbackNo)) {
        return false;
    }
    else {
        var ret = is_valid_callback(s);
        if (ret == 0) return false;
        else return true;
    }
    return true;
}


function Replace(str, original, replacement) {
    var result;
    result = "";
    while (str.indexOf(original) != -1) {
        if (str.indexOf(original) > 0)
            result = result + str.substring(0, str.indexOf(original)) + replacement;
        else
            result = result + replacement;
        str = str.substring(str.indexOf(original) + original.length, str.length);
    }
    return result + str;
}

function getBounds(obj) {
    var ret = new Object();

    if (document.all) {
        var rect = obj.getBoundingClientRect();
        ret.left = rect.left + (document.documentElement.scrollLeft || document.body.scrollLeft);
        ret.top = rect.top + (document.documentElement.scrollTop || document.body.scrollTop);
        ret.width = rect.right - rect.left;
        ret.height = rect.bottom - rect.top;
    }
    else {
        var box = document.getBoxObjectFor(obj);
        ret.left = box.x;
        ret.top = box.y;
        ret.width = box.width;
        ret.height = box.height;
    }

    return ret;
}


function DoCheckLang(str) {
    var inText = str;
    var ret;
    var chr;

    for (var i = 0; i < inText.length; i++) {
        ret = inText.charCodeAt(i);

        if (ret > 127 || ret == 6) {
            chr = inText.charAt(i);
            if (CHECK_CHARS.indexOf(chr) < 0) {
                alert("[" + chr + "] 문자는 휴대폰에서 지원하지 않는 문자입니다. ");
                return false;
            }
        }
    }
    return true;
}


function MsgBoxInit() 
{
    if (sTop.tBox_Msg.value == "") 
    {
        if (sTop.JascSMSType.value == "LMS")
        {
            sTop.tBox_Msg.value = LMSInitMsg;
        }
        else
        {
            sTop.tBox_Msg.value = InitMsg;
        }
    }
}

function tBoxFocusIn(Item) {
    if (Item == "Msg") 
    {
        if (sTop.JascSMSType.value == "LMS")
        {
            if (escape(sTop.tBox_Msg.value) == LMSTempMsg) 
            {
                sTop.tBox_Msg.value = "";
            }
        }
        else
        {
            if (escape(sTop.tBox_Msg.value) == TempMsg) {
                sTop.tBox_Msg.value = "";
            }
        }            
    }
    else if (Item == "Subject") {
        sTop.tBox_Subject.style.background = "url()";
    }
    else if (Item == "MobileNo") {
        sTop.tBox_MobileNo.style.background = "url()";
    }
    else if (Item == "UserName") {
        sTop.tBox_UserName.style.background = "url()";
    }
    else if (Item == "ComName") {
        sTop.tBox_ComName.style.background = "url()";
    }
    else if (Item == "tBox_OftenNo1") {
        sTop.tBox_OftenNo1.style.background = "url()";
    }
}

function tBoxFocusOut(Item) 
{
    if (Item == "Msg") {
        if (sTop.tBox_Msg.value == "") {
            if (sTop.JascSMSType.value == "LMS")
            {
                sTop.tBox_Msg.value = LMSInitMsg;
            }
            else
            {
                sTop.tBox_Msg.value = InitMsg;
            }            
        }
    }
    else if (Item == "Subject") {
        if (sTop.tBox_Subject.value == "") {
            sTop.tBox_Subject.style.background = "url('../Images/CloudSMS/sms_input_a006.gif') no-repeat 4px 2px #ffffff";
        }
    }
    else if (Item == "MobileNo") {
        if (sTop.tBox_MobileNo.value == "") {
            sTop.tBox_MobileNo.style.background = "url('../Images/CloudSMS/sms_input_a001.gif') no-repeat 4px 2px #ffffff";
        }
    }
    else if (Item == "UserName") {
        if (sTop.tBox_UserName.value == "") {
            sTop.tBox_UserName.style.background = "url('../Images/CloudSMS/sms_input_a002.gif') no-repeat 4px 2px #ffffff";
        }
    }
    else if (Item == "ComName") {
        if (sTop.tBox_ComName.value == "") {
            sTop.tBox_ComName.style.background = "url('../Images/CloudSMS/sms_input_a003.gif') no-repeat 4px 2px #ffffff";
        }
    }
    else if (Item == "tBox_OftenNo1") {
        if (sTop.tBox_OftenNo1.value == "") {
            sTop.tBox_OftenNo1.style.background = "url('../Images/CloudSMS/sms_input_a001.gif') no-repeat 4px 2px #ffffff";
        }
    }
}

function NextFocus(NextControl) {
    if (event.keyCode == 13) eval("sTop." + NextControl + ".focus()");
}

//========================================================
// 2013-08-07 guagua SMS 90Byte 변경
//========================================================
function MsgBoxKeyup() {
    var str;
    var str_count = 0;
    var cut_count = 0;
    var smslen = 90;
    var lmslen = 2000;
    var IsPass = 0;
    var tmp_str = "";
    var str_length = sTop.tBox_Msg.value.length;

    for (k = 0; k < str_length; k++)
    {
        str = sTop.tBox_Msg.value.charAt(k);

        if (escape(str).length > 4) {
            str_count += 2;
        }
        else {
            if (navigator.appVersion.indexOf("MSIE 9") > -1) {
                if (escape(str) != '%0D') {
                    str_count++;
                }  
            }
            else {
                if (escape(str) == '%0A') {
                    str_count++;
                }
                else if (escape(str) == '%0D') {
                }
                else {
                    str_count++;
                }
            }
        }
        if ((smslen < str_count) && (lmslen >= str_count))
        {
            if (document.getElementById("pn_LMSTooltip").style.visibility != "") 
            {
                if (sTop.HidLMSChangeNotice.value != "Y") {
                    document.getElementById("pn_LMSTooltip").style.visibility = "";
                    LMSTooltip();
                }

                //LMS상태로 전환
                document.getElementById("Msg80").innerText = "2000";
                
                document.getElementById("tBox_Msg").cols = "25";
                document.getElementById("tBox_Msg").className = "LMSMsgBox";                
            }
        }
        else if (str_count <= smslen) 
        {
            //SMS상태로 전환
            IsPass = 0;
            document.getElementById("Msg80").innerText = "90";
            document.getElementById("pn_LMSTooltip").style.visibility = "hidden";

            document.getElementById("tBox_Msg").cols = "20";
            document.getElementById("tBox_Msg").className = "MsgBox";            
        }
        else if (str_count > lmslen) {
            alert("2000바이트 이내에서 작성할 수 있습니다.");
            if (escape(str).length > 4) str_count -= 2;
            else str_count--;
            sTop.tBox_Msg.value = sTop.tBox_Msg.value.substring(0, k);
            break;
        }
    }
    document.getElementById("MsgLength").innerHTML = str_count;
}

//========================================================
// 2013-08-07 guagua SMS 90Byte 변경
//========================================================
function LMSMsgBoxKeyup() {
    var str;
    var str_count = 0;
    var cut_count = 0;
    var smslen = 90;
    var lmslen = 2000;
    var IsPass = 0;
    var str_length = sTop.tBox_Msg.value.length;

    for (k = 0; k < str_length; k++) {
        str = sTop.tBox_Msg.value.charAt(k);

        if (escape(str).length > 4) {
            str_count += 2;
        }
        else {
            if (navigator.appVersion.indexOf("MSIE 9") > -1) {
                if (escape(str) != '%0D') {
                    str_count++;
                }
            }
            else {
                if (escape(str) == '%0A') {
                    str_count++;
                }
                else if (escape(str) == '%0D') {
                }
                else {
                    str_count++;
                }
            }
        }
        if (str_count > lmslen) {
            alert("2000바이트 이내에서 작성할 수 있습니다.");
            if (escape(str).length > 4) str_count -= 2;
            else str_count--;
            sTop.tBox_Msg.value = sTop.tBox_Msg.value.substring(0, k);
            break;
        }
    }

    document.getElementById("MsgLength").innerHTML = str_count;
}

//========================================================
// 2013-08-07 guagua SMS 90Byte 변경
//========================================================
function ADMsgBoxKeyup() {
    var str;
    var str_count = 0;
    var cut_count = 0;
    var smslen = 49;
    var lmslen = 1959;
    var IsPass = 0;
    var str_length = sTop.tBox_Msg.value.length;

    for (k = 0; k < str_length; k++) {
        str = sTop.tBox_Msg.value.charAt(k);

        if (escape(str).length > 4) {
            str_count += 2;
        }
        else {
            if (navigator.appVersion.indexOf("MSIE 9") > -1) {
                if (escape(str) != '%0D') {
                    str_count++;
                }
            }
            else {
                if (escape(str) == '%0A') {
                    str_count++;
                }
                else if (escape(str) == '%0D') {
                }
                else {
                    str_count++;
                }
            }
        }
        if ((smslen < str_count) && (lmslen >= str_count)) {
            if (document.getElementById("pn_LMSTooltip").style.visibility != "") {
                if (sTop.HidLMSChangeNotice.value != "Y") {
                    document.getElementById("pn_LMSTooltip").style.visibility = "";
                    LMSTooltip();
                }

                //LMS상태로 전환
                document.getElementById("Msg80").innerText = "1967";
                
                document.getElementById("tBox_Msg").cols = "25";
                document.getElementById("tBox_Msg").className = "LMSMsgBox";
            }
        }
        else if (str_count <= smslen) {
            //SMS상태로 전환
            IsPass = 0;
            document.getElementById("Msg80").innerText = "49";
            document.getElementById("pn_LMSTooltip").style.visibility = "hidden";
            
            document.getElementById("tBox_Msg").cols = "20";
            document.getElementById("tBox_Msg").className = "MsgBox";
        }
        else if (str_count > lmslen) {
            alert("1967바이트 이내에서 작성할 수 있습니다.");
            if (escape(str).length > 4) str_count -= 2;
            else str_count--;
            sTop.tBox_Msg.value = sTop.tBox_Msg.value.substring(0, k);
            break;
        }
    }

    document.getElementById("MsgLength").innerHTML = str_count;
}

function LMSTooltip() {
    var pn_tooltip = document.getElementById("pn_LMSTooltip");

    if (pn_tooltip != null) {
        var tBoxPos = getBounds(document.getElementById("TooltipPosition"));

        pn_tooltip.style.top = (tBoxPos.top + -20) + "px";
        pn_tooltip.style.left = (tBoxPos.left + 120) + "px";
        pn_tooltip.style.zIndex = "1";
    }
}

function SpecialChar() {
    var pn_specialcharacter = document.getElementById("Div_SpecialCharacter");

    if (pn_specialcharacter != null) {
        if (pn_specialcharacter.style.visibility == "hidden") {
            var tBoxPos = getBounds(document.getElementById("img_specialcharacter"));

            pn_specialcharacter.style.top = (tBoxPos.top - 40) + "px";
            pn_specialcharacter.style.left = (tBoxPos.left + 56) + "px";
            pn_specialcharacter.style.zIndex = "1";

            pn_specialcharacter.style.visibility = "";
        }
        else {
            pn_specialcharacter.style.visibility = "hidden";
        }
    }
}

function SendNowClick() {
    sTop.rBox_SendNow.checked = true;

    document.getElementById("Div_ReservationInfo").innerHTML = "";
}

function SendReserClick() {
    sTop.rBox_SendReser.checked = true;

    document.getElementById("Div_ReservationInfo").innerHTML = document.getElementById("Div_ReserHTML").innerHTML;
    document.getElementById("Div_ReservationInfo").style.visibility = "";
}

function ReservationCalendarOpen() {
    var pn_ReservationCalendar = document.getElementById("Div_ReservationCalendar");

    if (Div_ReservationCalendar != null) {
        if (pn_ReservationCalendar.style.visibility == "hidden") {
            var tBoxPos = getBounds(document.getElementById("Img_ReservationCalendar"));

            pn_ReservationCalendar.style.top = (tBoxPos.top - 186) + "px";
            pn_ReservationCalendar.style.left = (tBoxPos.left - 170) + "px";
            pn_ReservationCalendar.style.zIndex = "1";

            pn_ReservationCalendar.style.visibility = "";
        } else {
            pn_ReservationCalendar.style.visibility = "hidden";
        }
    }
}

function onReservationCalendarChange(sender, selectedDate) {

    var y = document.getElementById("ddl_ReserYear");
    for (var i = 0; i < y.length; i++) {
        if (y[i].value == sender.formatDate(selectedDate, "yyyy").toString()) {
            y[i].selected = true;
        }
    }

    var m = document.getElementById("ddl_ReserMonth");
    var mValue = parseInt(sender.formatDate(selectedDate, "MM").toString());
    for (var i = 0; i < m.length; i++) {
        if (m[i].value == mValue) {
            m[i].selected = true;
        }
    }

    var d = document.getElementById("ddl_ReserDay");
    var dValue = parseInt(sender.formatDate(selectedDate, "dd").toString());
    for (var i = 0; i < d.length; i++) {
        if (d[i].value == dValue) {
            d[i].selected = true;
        }
    }

    document.getElementById("Div_ReservationCalendar").style.visibility = "hidden";
}

function RecvNoAdd() {
    var strHTML, strInnerHTML;
    var DivName, UniqKey;

    var AddrMode = sTop.HidAddrMode.value;
    var MobileNo = sTop.tBox_MobileNo.value;
    var UserName = sTop.tBox_UserName.value;
    var ComName = sTop.tBox_ComName.value;

    if (sTop.tBox_MobileNo.value == "") {
        alert("휴대폰 번호를 입력해 주세요.");
        return false;
    }
    else if (sTop.tBox_MobileNo.value.length < 10) {
        alert("잘못된 휴대폰 번호 입니다. [" + sTop.tBox_MobileNo.value + "]\n확인 후 다시 입력해 주세요.");
        sTop.tBox_MobileNo.value = "";
        tBoxFocusOut("MobileNo");
        return false;
    }
    else if (sTop.tBox_MobileNo.value.substring(0, 3) != "010" && sTop.tBox_MobileNo.value.substring(0, 3) != "011" && sTop.tBox_MobileNo.value.substring(0, 3) != "016" && sTop.tBox_MobileNo.value.substring(0, 3) != "017" && sTop.tBox_MobileNo.value.substring(0, 3) != "018" && sTop.tBox_MobileNo.value.substring(0, 3) != "019") {
        alert("잘못된 휴대폰 번호 입니다. [" + sTop.tBox_MobileNo.value + "]\n확인 후 다시 입력해 주세요.");
        sTop.tBox_MobileNo.value = "";
        tBoxFocusOut("MobileNo");
        return false;
    }
    else if (!IsMobileNo(MobileNo)) {
        alert("잘못된 휴대폰 번호 입니다. [" + sTop.tBox_MobileNo.value + "]\n휴대폰 번호는 숫자, - 만 입력할 수 있습니다.\n\n확인 후 다시 입력해 주세요.");
        sTop.tBox_MobileNo.value = "";
        tBoxFocusOut("MobileNo");
        return false;
    }

    if ((AddrMode == "") || (AddrMode == "Add")) {
        strHTML = document.getElementById("Div_RecvNo").innerHTML;

        //받는사람 목록에 추가할 수 있는지 여부
        if (!IsUseRecvNo(strHTML)) {
            alert("텍스트(txt)파일이 첨부된 경우에는 받는사람을 추가할 수 없습니다.");
            return;
        }

        UniqKey = parseInt(document.getElementById("Div_RecvNo").children.length) + 1;
        DivName = "Div_RecvNoItem" + UniqKey.toString();
        UniqKey = "RecvNoItem" + UniqKey.toString();

        strInnerHTML = '<div id="' + DivName + '" uniqkey="' + UniqKey.toString() + '" iType="MobileNo" class="BoxBottomtBorder HandCursor">';
        strInnerHTML = strInnerHTML + '<span class="css_MobileNo" OnClick="RecvNoItemClick(\'' + UniqKey.toString() + '\')">' + MobileNo + '</span>';
        strInnerHTML = strInnerHTML + '<span class="css_Name" OnClick="RecvNoItemClick(\'' + UniqKey.toString() + '\')">' + UserName + '</span>';
        strInnerHTML = strInnerHTML + '<span class="css_ComName" OnClick="RecvNoItemClick(\'' + UniqKey.toString() + '\')">' + ComName + '</span>';
        strInnerHTML = strInnerHTML + '<span class="css_RemoveBtn"><img src="../Images/CloudSMS/sms_btn_del.gif" OnClick="RecvNoItemRemove(\'' + UniqKey.toString() + '\')" border="0"></span>';
        strInnerHTML = strInnerHTML + '</div>';

        document.getElementById("Div_RecvNo").innerHTML = strInnerHTML + strHTML;
    }
    else if (AddrMode == "Modify") {
        var AddrSelectItem = sTop.HidAddrSelectItem.value;
        for (var i = 0; i < document.getElementById("Div_RecvNo").children.length; i++) {
            var s = document.getElementById("Div_RecvNo").children[i].id;
            s = Replace(s, "Div_RecvNoItem", "RecvNoItem");
        
            if (s == AddrSelectItem) {
                document.getElementById("Div_RecvNo").children[i].style.backgroundColor = "#ffffff";
                document.getElementById("Div_RecvNo").children[i].children[0].innerHTML = MobileNo;
                document.getElementById("Div_RecvNo").children[i].children[1].innerHTML = UserName;
                document.getElementById("Div_RecvNo").children[i].children[2].innerHTML = ComName;
            }
        }

        document.getElementById("ib_AddrInput").src = "../Images/CloudSMS/sms_input_btn001.gif";

        sTop.HidAddrMode.value = "";
        sTop.HidAddrSelectItem.value = "";
    }

    RecvNoCount();

    sTop.tBox_MobileNo.value = "";
    tBoxFocusIn("MobileNo");
    sTop.tBox_UserName.value = "";
    tBoxFocusOut("UserName");
    sTop.tBox_ComName.value = "";
    tBoxFocusOut("ComName");

    sTop.tBox_MobileNo.focus();
    
    return false;
}

function RecvNoAdd2(MobileNo, UserName, ComName) {
    var strHTML, strInnerHTML;
    var DivName, UniqKey;

    if (MobileNo == "") {
        alert("휴대폰 번호를 입력해 주세요.");
        return false;
    }
    else if (MobileNo.length < 10) {
        alert("잘못된 휴대폰 번호 입니다. [" + MobileNo + "]\n확인 후 다시 입력해 주세요.");
        return false;
    }
    else if (MobileNo.substring(0, 3) != "010" && MobileNo.substring(0, 3) != "011" && MobileNo.substring(0, 3) != "016" && MobileNo.substring(0, 3) != "017" && MobileNo.substring(0, 3) != "018" && MobileNo.substring(0, 3) != "019") {
        alert("잘못된 휴대폰 번호 입니다. [" + MobileNo + "]\n확인 후 다시 입력해 주세요.");
        return false;
    }
    else if (!IsMobileNo(MobileNo)) {
        alert("잘못된 휴대폰 번호 입니다. [" + MobileNo + "]\n휴대폰 번호는 숫자, - 만 입력할 수 있습니다.\n\n확인 후 다시 입력해 주세요.");
        return false;
    }

    strHTML = document.getElementById("Div_RecvNo").innerHTML;

    //받는사람 목록에 추가할 수 있는지 여부
    if (!IsUseRecvNo(strHTML)) {
        alert("텍스트(txt)파일이 첨부된 경우에는 받는사람을 추가할 수 없습니다.");
        return false;
    }

    UniqKey = parseInt(document.getElementById("Div_RecvNo").children.length) + 1;
    DivName = "Div_RecvNoItem" + UniqKey.toString();
    UniqKey = "RecvNoItem" + UniqKey.toString();

    strInnerHTML = '<div id="' + DivName + '" uniqkey="' + UniqKey.toString() + '" iType="MobileNo" class="BoxBottomtBorder HandCursor">';
    strInnerHTML = strInnerHTML + '<span class="css_MobileNo" OnClick="RecvNoItemClick(\'' + UniqKey.toString() + '\')">' + MobileNo + '</span>';
    strInnerHTML = strInnerHTML + '<span class="css_Name" OnClick="RecvNoItemClick(\'' + UniqKey.toString() + '\')">' + UserName + '</span>';
    strInnerHTML = strInnerHTML + '<span class="css_ComName" OnClick="RecvNoItemClick(\'' + UniqKey.toString() + '\')">' + ComName + '</span>';
    strInnerHTML = strInnerHTML + '<span class="css_RemoveBtn"><img src="../Images/CloudSMS/sms_btn_del.gif" OnClick="RecvNoItemRemove(\'' + UniqKey.toString() + '\')" border="0"></span>';
    strInnerHTML = strInnerHTML + '</div>';

    document.getElementById("Div_RecvNo").innerHTML = strInnerHTML + strHTML;

    RecvNoCount();

    return true;
}

function MobileNoKeyDown() {
    if (event.keyCode == 13) {
        RecvNoAdd();
    }
}


function RecvNoItemClick(uKey) 
{
    var strHTML;

    if (uKey.length > 0) 
    {
        sTop.HidAddrMode.value = "Modify";
        sTop.HidAddrSelectItem.value = uKey;
    
        strHTML = document.getElementById("Div_RecvNo").innerHTML;
        for (var i = 0; i < document.getElementById("Div_RecvNo").children.length; i++) 
        {
            var s = document.getElementById("Div_RecvNo").children[i].id;
            s = Replace(s, "Div_RecvNoItem", "RecvNoItem");
            
            if (s != uKey) {
                document.getElementById("Div_RecvNo").children[i].style.backgroundColor = "#ffffff";
            }
            else {
                document.getElementById("Div_RecvNo").children[i].style.backgroundColor = "#f8f8f8";
                sTop.tBox_MobileNo.value = document.getElementById("Div_RecvNo").children[i].children[0].innerHTML;
                sTop.tBox_UserName.value = document.getElementById("Div_RecvNo").children[i].children[1].innerHTML;
                sTop.tBox_ComName.value = document.getElementById("Div_RecvNo").children[i].children[2].innerHTML;

                document.getElementById("ib_AddrInput").src = "../Images/CloudSMS/sms_btn_mod.gif";

                tBoxFocusIn("MobileNo");
                tBoxFocusIn("UserName");
                tBoxFocusIn("ComName");
            }
        }
    }
}

function RecvNoItemRemove(uKey) {
    var strHTML;
    var strRecvNoHTML = "";

    if (uKey.length > 0) {
        strHTML = document.getElementById("Div_RecvNo").innerHTML;
        for (var i = 0; i < document.getElementById("Div_RecvNo").children.length; i++) 
        {
            var s = document.getElementById("Div_RecvNo").children[i].id;
            s = Replace(s, "Div_RecvNoItem", "RecvNoItem");

            if (s == uKey) {
            }
            else {
                strRecvNoHTML = strRecvNoHTML + document.getElementById("Div_RecvNo").children[i].outerHTML;
            }
        }

        document.getElementById("Div_RecvNo").innerHTML = strRecvNoHTML;

        RecvNoCount();
    }
}

function RecvNoCount() {
    document.getElementById("RecvNoCountText").innerHTML = document.getElementById("Div_RecvNo").children.length;
}

function OverlapingCheck() {
    if (sTop.cBox_Overlaping.checked) {
        sTop.cBox_Overlaping.checked = false;
    }
    else {
        sTop.cBox_Overlaping.checked = true;
    }
}

function SubjectCheck() {
    if (sTop.cBox_Subject.checked) {
        sTop.cBox_Subject.checked = false;
    }
    else {
        sTop.cBox_Subject.checked = true;
    }
}

function SpecialCharacterAdd(s) {
    var TempMsg2;
    
    if (sTop.JascSMSType.value == "LMS")
    {
        TempMsg2 = LMSTempMsg;
    }
    else
    {
        TempMsg2 = TempMsg;
    }
    
    if (escape(sTop.tBox_Msg.value) == TempMsg2) {
            sTop.tBox_Msg.value = s;
    }
    else {
            sTop.tBox_Msg.value = sTop.tBox_Msg.value + s;
    }

    if (sTop.JascSMSType.value == "SMS") {
        MsgBoxKeyup();
    } else if (sTop.JascSMSType.value == "LMS") {
        LMSMsgBoxKeyup();
    } else if (sTop.JascSMSType.value == "AD") {
        ADMsgBoxKeyup();
    }
}

function OftenNo() {
    document.getElementById("Div_OftenNo").innerHTML = OftenNoFrame.document.getElementById("Div_OftenNoFrame").innerHTML;

    var pn_OftenNo = document.getElementById("Div_OftenNo");

    if (pn_OftenNo != null) {
        if (pn_OftenNo.style.visibility == "hidden") {
            var tBoxPos = getBounds(document.getElementById("Img_OftenNo"));

            pn_OftenNo.style.top = (tBoxPos.top + 28) + "px";
            pn_OftenNo.style.left = (tBoxPos.left - 195) + "px";
            pn_OftenNo.style.zIndex = "1";

            pn_OftenNo.style.visibility = "";
        } else {
            pn_OftenNo.style.visibility = "hidden";
        }
    }
}

function AddOftenNo(item) {
    var ActionFile, DatatoSend, ReturnValue;
    var MobileNo, UserName, ComName;

    MobileNo = eval("document.all.tBox_" + item + ".value");
    UserName = eval("document.all.tBox_" + item + "_Name.value");
    ComName = eval("document.all.tBox_" + item + "_ComName.value");

    if (MobileNo == "") {
        alert("핸드폰 번호를 입력해 주세요.");
        return false;
    }
    else if (MobileNo.length < 10) {
        alert("잘못된 휴대폰 번호 입니다. [" + MobileNo + "]\n확인 후 다시 입력해 주세요.");
        return false;
    }
    else if (MobileNo.substring(0, 3) != "010" && MobileNo.substring(0, 3) != "011" && MobileNo.substring(0, 3) != "016" && MobileNo.substring(0, 3) != "017" && MobileNo.substring(0, 3) != "018" && MobileNo.substring(0, 3) != "019") {
        alert("잘못된 휴대폰 번호 입니다. [" + MobileNo + "]\n확인 후 다시 입력해 주세요.");
        return false;
    }
    else if (!IsMobileNo(MobileNo)) {
        alert("잘못된 휴대폰 번호 입니다. [" + MobileNo + "]\n휴대폰 번호는 숫자, - 만 입력할 수 있습니다.\n\n확인 후 다시 입력해 주세요.");
        return false;
    }

    ActionFile = "AjaxSMS.aspx";
    DatatoSend = "JobFlag=AddOftenNo&MobileNo=" + MobileNo + "&UserName=" + escape(UserName) + "&ComName=" + escape(ComName);
    ReturnValue = GetXmlHTTP(ActionFile, DatatoSend);
    
    if (typeof ReturnValue != "undefined") 
    {
        if (ReturnValue == "1") 
        {
            alert("저장 되었습니다.");
            document.getElementById("Div_OftenNo").style.visibility = "hidden";
            document.getElementById("Div_OftenNo").innerHTML = "";
            OftenNoFrame.location.href = "OftenNo.aspx?";
        }
        else if (ReturnValue == "100") 
        {
            alert("로그인 해주세요.");
        }
        else
        {
            alert("저장 중 오류가 발생하였습니다.");
        }
    }
}

function ModifyOftenNo(item, OftenNoKey) {
    var ActionFile, DatatoSend, ReturnValue;
    var MobileNo, UserName, ComName;
    
    MobileNo = eval("document.all.tBox_" + item + ".value");
    UserName = eval("document.all.tBox_" + item + "_Name.value");
    ComName = eval("document.all.tBox_" + item + "_ComName.value");

    if (MobileNo == "") {
        alert("핸드폰 번호를 입력해 주세요.");
        return false;
    }
    else if (MobileNo.length < 10) {
        alert("잘못된 휴대폰 번호 입니다. [" + MobileNo + "]\n확인 후 다시 입력해 주세요.");
        return false;
    }
    else if (MobileNo.substring(0, 3) != "010" && MobileNo.substring(0, 3) != "011" && MobileNo.substring(0, 3) != "016" && MobileNo.substring(0, 3) != "017" && MobileNo.substring(0, 3) != "018" && MobileNo.substring(0, 3) != "019") {
        alert("잘못된 휴대폰 번호 입니다. [" + MobileNo + "]\n확인 후 다시 입력해 주세요.");
        return false;
    }
    else if (!IsMobileNo(MobileNo)) {
        alert("잘못된 휴대폰 번호 입니다. [" + MobileNo + "]\n휴대폰 번호는 숫자, - 만 입력할 수 있습니다.\n\n확인 후 다시 입력해 주세요.");
        return false;
    }

    ActionFile = "AjaxSMS.aspx";
    DatatoSend = "JobFlag=ModifyOftenNo&OftenNoKey=" + OftenNoKey + "&MobileNo=" + MobileNo + "&UserName=" + escape(UserName) + "&ComName=" + escape(ComName);
    ReturnValue = GetXmlHTTP(ActionFile, DatatoSend);

    if (typeof ReturnValue != "undefined") {
        if (ReturnValue == "1") {
            alert("저장 되었습니다.");
            document.getElementById("Div_OftenNo").style.visibility = "hidden";
            document.getElementById("Div_OftenNo").innerHTML = "";
            OftenNoFrame.location.href = "OftenNo.aspx";
        }
        else if (ReturnValue == "100") {
            alert("로그인 해주세요.");
        }
        else {
            alert("저장 중 오류가 발생하였습니다.");
        }
    }
}

function RemoveOftenNo(OftenNoKey) {
    var ActionFile, DatatoSend, ReturnValue;

    ActionFile = "AjaxSMS.aspx";
    DatatoSend = "JobFlag=RemoveOftenNo&OftenNoKey=" + OftenNoKey;
    ReturnValue = GetXmlHTTP(ActionFile, DatatoSend);

    if (typeof ReturnValue != "undefined") {
        if (ReturnValue == "1") {
            alert("삭제 되었습니다.");
            document.getElementById("Div_OftenNo").style.visibility = "hidden";
            document.getElementById("Div_OftenNo").innerHTML = "";
            OftenNoFrame.location.href = "OftenNo.aspx";
        }
        else if (ReturnValue == "100") {
            alert("로그인 해주세요.");
        }
        else {
            alert("삭제 중 오류가 발생하였습니다.");
        }
    }
}

function AddReveNoByOftenNo() {
    var blnRetValue;
    for (var i = 10; i > 0; i--) 
    {
        var MobileNo, UserName, ComName;
        var chkValue = eval("sTop.cBox_OftenNo" + i.toString() + ".checked");
        if (chkValue == true) {
            MobileNo = eval("sTop.tBox_OftenNo" + i.toString() + ".value");
            UserName = eval("sTop.tBox_OftenNo" + i.toString() + "_Name.value");
            ComName = eval("sTop.tBox_OftenNo" + i.toString() + "_ComName.value");

            blnRetValue = RecvNoAdd2(MobileNo, UserName, ComName);

            if (!blnRetValue) {
                break;
            }
        }
    }

    OftenNo();
}

function OftenNoFocusIn(Item, Idx) {
    switch(Item)
    {
        case "MobileNo":
            eval("sTop.tBox_OftenNo" + Idx + ".style.background = \"url()\"");
            break;
        case "UserName":
            eval("sTop.tBox_OftenNo" + Idx + "_Name.style.background = \"url()\"");
            break;
        case "ComName":
            eval("sTop.tBox_OftenNo" + Idx + "_ComName.style.background = \"url()\"");
            break;
    }
}

function OftenNoFocusOut(Item, Idx) {
    switch(Item)
    {
        case "MobileNo":
            if (eval("sTop.tBox_OftenNo" + Idx + ".value == \"\"")) {
                eval("sTop.tBox_OftenNo" + Idx + ".style.background = \"url('../Images/CloudSMS/sms_input_a001.gif') no-repeat 4px 2px #ffffff\"");
            }
            break;
        case "UserName":
            if (eval("sTop.tBox_OftenNo" + Idx + "_Name.value == \"\"")) {
                eval("sTop.tBox_OftenNo" + Idx + "_Name.style.background = \"url('../Images/CloudSMS/sms_input_a002.gif') no-repeat 4px 2px #ffffff\"");
            }
            break;
        case "ComName":
            if (eval("sTop.tBox_OftenNo" + Idx + "_ComName.value == \"\"")) {
                eval("sTop.tBox_OftenNo" + Idx + "_ComName.style.background = \"url('../Images/CloudSMS/sms_input_a003.gif') no-repeat 4px 2px #ffffff\"");
            }
            break;
    }
}

/* [사용안함] 2015-12-24 guagua */
/*
function CallbackNoView() {
    document.getElementById("Div_CallbackNo").innerHTML = CallbackNoFrame.document.getElementById("Div_CallbackNoFrame").innerHTML;

    var pn_CallbackNo = document.getElementById("Div_CallbackNo");

    if (pn_CallbackNo != null) {
        if (pn_CallbackNo.style.visibility == "hidden") {
            var tBoxPos = getBounds(document.getElementById("Img_CallbackNo"));

            pn_CallbackNo.style.top = (tBoxPos.top - 280) + "px";
            pn_CallbackNo.style.left = (tBoxPos.left - 120) + "px";
            pn_CallbackNo.style.zIndex = "1";

            pn_CallbackNo.style.visibility = "";
        } else {
            pn_CallbackNo.style.visibility = "hidden";
        }
    }
}
*/

function AddCallbackNo(item) {
    var ActionFile, DatatoSend, ReturnValue;
    var CallbackNo;

    CallbackNo = eval("document.all.tBox_" + item + ".value");

    if (CallbackNo == "") {
        alert("회신번호를 입력해 주세요.");
        return false;
    }
    else if (!IsCallbackNo(CallbackNo)) {
        alert("잘못된 회신번호 입니다. [" + CallbackNo + "]\n회신번호는 숫자, - 만 입력할 수 있습니다.\n\n확인 후 다시 입력해 주세요.");
        return false;
    }

    ActionFile = "AjaxSMS.aspx";
    DatatoSend = "JobFlag=AddCallbackNo&CallbackNo=" + CallbackNo;
    ReturnValue = GetXmlHTTP(ActionFile, DatatoSend);

    if (typeof ReturnValue != "undefined") {
        if (ReturnValue == "1") {
            alert("저장 되었습니다.");
            document.getElementById("Div_CallbackNo").style.visibility = "hidden";
            document.getElementById("Div_CallbackNo").innerHTML = "";
            CallbackNoFrame.location.href = "CallbackNo.aspx";
        }
        else if (ReturnValue == "100") {
            alert("로그인 해주세요.");
        }
        else {
            alert("저장 중 오류가 발생하였습니다.");
        }
    }
}

function ModifyCallbackNo(item, CallbackNoKey) {
    var ActionFile, DatatoSend, ReturnValue;
    var MobileNo, UserName, ComName;

    CallbackNo = eval("document.all.tBox_" + item + ".value");

    if (CallbackNo == "") {
        alert("회신번호를 입력해 주세요.");
        return false;
    }
    else if (!IsCallbackNo(CallbackNo)) {
        alert("잘못된 회신번호 입니다. [" + CallbackNo + "]\n회신번호는 숫자, - 만 입력할 수 있습니다.\n\n확인 후 다시 입력해 주세요.");
        return false;
    }

    ActionFile = "AjaxSMS.aspx";
    DatatoSend = "JobFlag=ModifyCallbackNo&CallbackNoKey=" + CallbackNoKey + "&CallbackNo=" + CallbackNo;
    ReturnValue = GetXmlHTTP(ActionFile, DatatoSend);

    if (typeof ReturnValue != "undefined") {
        if (ReturnValue == "1") {
            alert("저장 되었습니다.");
            document.getElementById("Div_CallbackNo").style.visibility = "hidden";
            document.getElementById("Div_CallbackNo").innerHTML = "";
            CallbackNoFrame.location.href = "CallbackNo.aspx";
        }
        else if (ReturnValue == "100") {
            alert("로그인 해주세요.");
        }
        else {
            alert("저장 중 오류가 발생하였습니다.");
        }
    }
}

function RemoveCallbackNo(CallbackNoKey) {
    var ActionFile, DatatoSend, ReturnValue;

    ActionFile = "AjaxSMS.aspx";
    DatatoSend = "JobFlag=RemoveCallbackNo&CallbackNoKey=" + CallbackNoKey;
    ReturnValue = GetXmlHTTP(ActionFile, DatatoSend);

    if (typeof ReturnValue != "undefined") {
        if (ReturnValue == "1") {
            alert("삭제 되었습니다.");
            document.getElementById("Div_CallbackNo").style.visibility = "hidden";
            document.getElementById("Div_CallbackNo").innerHTML = "";
            CallbackNoFrame.location.href = "CallbackNo.aspx";
        }
        else if (ReturnValue == "100") {
            alert("로그인 해주세요.");
        }
        else {
            alert("삭제 중 오류가 발생하였습니다.");
        }
    }
}

function AddReveNoByCallbackNo() {
    var CallbackNo;
    for (var i = 0; i < sTop.rBox_CallbackNo.length; i++) {
        if (sTop.rBox_CallbackNo[i].checked) {
            sTop.tBox_CallbackNo.value = eval("sTop.tBox_CallbackNo" + (i + 1).toString() + ".value");
            break;
        }
    }

    CallbackNoView();
}

function SMSTextSendOpen() {
    var iWidth, iHeight, thisX, thisY, xx, yy;
    var winTop;

    if (!IsUseRecvNo(document.getElementById("Div_RecvNo").innerHTML)) {
        alert("받는사람 목록에 이미 다른 항목이 추가된 경우에는 텍스트(txt)파일을 추가할 수 없습니다.");
        return;
    }

    winTop = parent;

    iWidth = 434;
    iHeight = 606;

    thisX = screen.availWidth;
    thisY = screen.availHeight;

    xx = (thisX / 2) - (iWidth / 2)
    yy = (thisY / 2) - (iHeight / 2)

    var win = window.open("SMSTextSend.aspx", "SMSTextSend1", "left=" + xx + ",top=" + yy + ",width=" + iWidth + ",height=" + iHeight + ", scrollbars=no,menubar=no,resizable=no");
    win.focus();
}

function SMSTextSendClose() {
    self.window.close();
}

function SMSTextSendOK() {
    if (sTop.fu_SMSText.value == "") {
        alert("파일을 선택해 주세요.");
        sTop.fu_SMSText.focus();
        return false;
    }
    else {
        return true;
    }
}

function IsUseRecvNo(RecvNoHTML) {
    var blnRetValue = true;

    if (sTop.HidTextFileName.value.length > 0) {
        blnRetValue = false;
    }

    return blnRetValue;
}

function TextFileItemRemove() {
    document.getElementById("Div_RecvNo").innerHTML = "";
    document.getElementById("RecvNoCountText").innerHTML = "0";
    sTop.HidTextFileName.value = "";

    //받는사람 추가할수 있도록 처리
    sTop.tBox_MobileNo.disabled = false;
    sTop.tBox_UserName.disabled = false;
    sTop.tBox_ComName.disabled = false;
}

function TextFileAddResult(FileName, OrgFileName, RecordCount) {
    var strHTML, UniqKey, DivName, strInnerHTML;

    strHTML = document.getElementById("Div_RecvNo").innerHTML;
    if (Replace(strHTML, " ", "").length > 1) {
        alert("받는사람 목록에 이미 다른 항목이 추가된 경우에는 텍스트(txt)파일을 추가할 수 없습니다.");
        return;
    }

    sTop.HidTextFileName.value = FileName;

    UniqKey = 1;
    DivName = "Div_RecvNoItem" + UniqKey.toString();
    UniqKey = "RecvNoItem" + UniqKey.toString();

    strInnerHTML = '<div id="' + DivName + '" uniqkey="' + UniqKey.toString() + '" iType="TextFile" class="BoxBottomtBorder HandCursor">';
    strInnerHTML = strInnerHTML + '<span class="css_FileAdd">' + OrgFileName + " (" + RecordCount + "개)" + '</span>';
    strInnerHTML = strInnerHTML + '<span class="css_RemoveBtn"><img src="../Images/CloudSMS/sms_btn_del.gif" OnClick="TextFileItemRemove()" border="0"></span>';
    strInnerHTML = strInnerHTML + '</div>';

    document.getElementById("Div_RecvNo").innerHTML = strInnerHTML + strHTML;
    document.getElementById("RecvNoCountText").innerHTML = RecordCount;

    //받는사람 추가하지 못하도록 처리
    sTop.tBox_MobileNo.disabled = true;
    sTop.tBox_UserName.disabled = true;
    sTop.tBox_ComName.disabled = true;
}

function UseNoView() {
    document.getElementById("Div_UseNo").innerHTML = UseNoFrame.document.getElementById("Div_UseNoFrame").innerHTML;

    var pn_UseNo = document.getElementById("Div_UseNo");

    if (pn_UseNo != null) {
        if (pn_UseNo.style.visibility == "hidden") {
            var tBoxPos = getBounds(document.getElementById("Img_UseNo"));

            pn_UseNo.style.top = (tBoxPos.top + 27) + "px";
            pn_UseNo.style.left = (tBoxPos.left - 196) + "px";
            pn_UseNo.style.zIndex = "1";

            pn_UseNo.style.visibility = "";
        } else {
            pn_UseNo.style.visibility = "hidden";
        }
    }
}

function AddReveNoByUseNo() {
    var blnRetValue;
    for (var i = 10; i > 0; i--) {
        var MobileNo, UserName, ComName;
        var chkValue = eval("sTop.cBox_UseNo" + i.toString() + ".checked");
        if (chkValue == true) {
            MobileNo = eval("document.getElementById(\"tBox_SendNo" + i.toString() + "\").value");
            UserName = eval("document.getElementById(\"tBox_SendNo" + i.toString() + "_UserName\").value");
            ComName = eval("document.getElementById(\"tBox_SendNo" + i.toString() + "_ComName\").value");
            
            blnRetValue = RecvNoAdd2(MobileNo, UserName, ComName);

            if (!blnRetValue) {
                break;
            }
        }
    }

    UseNoView();
}

function AddLoginUserName() {
    if (sTop.HidLoginUserName.value == "") {
        alert("사용자 이름이 입력되어 있지 않습니다.\n\n관리자메뉴의 사용자관리 메뉴에서 사용자 이름을 입력해 주세요.");
        return false;
    }
    
    var TempMsg2;
    if(sTop.JascSMSType.value == "LMS")
    {
        TempMsg2 = LMSTempMsg;
    }
    else
    {
        TempMsg2 = TempMsg;
    }
    
    if (escape(sTop.tBox_Msg.value) == TempMsg2) {
        sTop.tBox_Msg.value = sTop.HidLoginUserName.value;
    }
    else {
        sTop.tBox_Msg.value = sTop.tBox_Msg.value + sTop.HidLoginUserName.value;
    }

    if (sTop.JascSMSType.value == "SMS") {
        MsgBoxKeyup();
    } else if (sTop.JascSMSType.value == "LMS") {
        LMSMsgBoxKeyup();
    } else if (sTop.JascSMSType.value == "AD") {
        ADMsgBoxKeyup();
    }
}

function AddLoginComName() {
    if (sTop.HidLoginComName.value == "") {
        alert("회사명이 입력되어 있지 않습니다.\n\n관리자메뉴의 회사정보 메뉴에서 회사명을 입력해 주세요.");
        return false;
    }
    
    var TempMsg2;
    if(sTop.JascSMSType.value == "LMS")
    {
        TempMsg2 = LMSTempMsg;
    }
    else
    {
        TempMsg2 = TempMsg;
    }

    if (escape(sTop.tBox_Msg.value) == TempMsg2) {
        sTop.tBox_Msg.value = sTop.HidLoginComName.value;
    }
    else {
        sTop.tBox_Msg.value = sTop.tBox_Msg.value + sTop.HidLoginComName.value;
    }

    if (sTop.JascSMSType.value == "SMS") {
        MsgBoxKeyup();
    } else if (sTop.JascSMSType.value == "LMS") {
        LMSMsgBoxKeyup();
    } else if (sTop.JascSMSType.value == "AD") {
        ADMsgBoxKeyup();
    }
}

function MsgKeepBoxView() {
    var iWidth, iHeight, thisX, thisY, xx, yy;
    var winTop;
    var SMSType1, SMSType2;

    if (sTop.JascSMSType.value == "AD") {
        SMSType1 = "SMS";
        SMSType2 = "AD";
    } else {
        SMSType1 = sTop.JascSMSType.value;
        SMSType2 = sTop.JascSMSType.value;
    }

    winTop = parent;

    iWidth = 747;
    iHeight = 603;

    thisX = winTop.document.body.clientWidth;
    //thisY = winTop.document.body.clientHeight;
    thisY = 852;
    

    xx = (thisX / 2) - (iWidth / 2)
    yy = (thisY / 2) - (iHeight / 2)

    var win_SMSMsgKeepBox = window.open("SMSMsgKeepBox.aspx?SMSType=" + SMSType1 + "&OpenWinSMSType=" + SMSType2, "SMSMsgKeepBox", "left=" + xx + ",top=" + yy + ",width=" + iWidth + ",height=" + iHeight + ", scrollbars=no,menubar=no,resizable=no");
    win_SMSMsgKeepBox.focus();
}

function MsgKeepBoxKeyup(item, msgMaxLength, msgLengthControl) {
    var str;
    var str_count = 0;
    var cut_count = 0;
    var smslen = msgMaxLength;
    var IsPass = 0;
    var str_length = item.value.length;

    for (k = 0; k < str_length; k++) {
        str = item.value.charAt(k);

        if (escape(str).length > 4) {
            str_count += 2;
        }
        else {
            if (navigator.appVersion.indexOf("MSIE 9") > -1) {
                if (escape(str) != '%0D') {
                    str_count++;
                }
            }
            else {
                if (escape(str) == '%0A') {
                    str_count++;
                }
                else if (escape(str) == '%0D') {
                }
                else {
                    str_count++;
                }
            }
        }
        if (str_count > smslen) {
            alert(msgMaxLength + "바이트 이내에서 작성할 수 있습니다.");
            if (escape(str).length > 4) str_count -= 2;
            else str_count--;
            item.value = item.value.substring(0, k);
            break;
        }
    }

    document.getElementById(msgLengthControl).innerHTML = str_count;
}

function MsgKeepSave(item, smsType) {

    var ActionFile, DatatoSend, ReturnValue;
    var itemValue;

    if (item == "") {
        alert("정보가 정확하지 않습니다.");
        return false;
    }

    if(smsType == "SMS")
    {
        itemValue = eval("sTop.tBox_MsgKeep" + item + ".value");
    }
    else
    {
        itemValue = eval("sTop.tBox_LMSMsgKeep" + item + ".value");
    }

    ActionFile = "AjaxSMS.aspx";
    DatatoSend = "JobFlag=AddMsgKeep&SMSType=" + sTop.HidSMSType.value + "&Msg=" + escape(itemValue) + "&SortIndex=" + item;
    ReturnValue = GetXmlHTTP(ActionFile, DatatoSend);

    if (typeof ReturnValue != "undefined") {
        if (ReturnValue == "1") {
            alert("저장 되었습니다.");
            location.href = "SMSMsgKeepBox.aspx?SMSType=" + sTop.HidSMSType.value + "&OpenWinSMSType=" + sTop.HidOpenWinSMSType.value;
        }
        else if (ReturnValue == "100") {
            alert("로그인 해주세요.");
        }
        else {
            alert("저장 중 오류가 발생하였습니다.");
        }
    }
}

function MsgKeepModify(MsgKeepKey, item, smsType) {
    var ActionFile, DatatoSend, ReturnValue;
    var itemValue;
    
    if ((MsgKeepKey == "") || (item == "")) {
        alert("정보가 정확하지 않습니다.");
        return false;
    }

    if(smsType == "SMS")
    {
        itemValue = eval("sTop.tBox_MsgKeep" + item + ".value");
    }
    else
    {
        itemValue = eval("sTop.tBox_LMSMsgKeep" + item + ".value");
    }

    ActionFile = "AjaxSMS.aspx";
    DatatoSend = "JobFlag=ModifyMsgKeep&MsgKeepKey=" + MsgKeepKey + "&Msg=" + escape(itemValue);
    ReturnValue = GetXmlHTTP(ActionFile, DatatoSend);

    if (typeof ReturnValue != "undefined") {
        if (ReturnValue == "1") {
            alert("저장 되었습니다.");
            location.href = "SMSMsgKeepBox.aspx?SMSType=" + sTop.HidSMSType.value + "&OpenWinSMSType=" + sTop.HidOpenWinSMSType.value;
        }
        else if (ReturnValue == "100") {
            alert("로그인 해주세요.");
        }
        else {
            alert("저장 중 오류가 발생하였습니다.");
        }
    }
}

function MsgKeepRemove(MsgKeepKey) {
    var ActionFile, DatatoSend, ReturnValue;
    var itemValue;

    if (MsgKeepKey == "") {
        alert("정보가 정확하지 않습니다.");
        return false;
    }

    ActionFile = "AjaxSMS.aspx";
    DatatoSend = "JobFlag=RemoveMsgKeep&MsgKeepKey=" + MsgKeepKey;
    ReturnValue = GetXmlHTTP(ActionFile, DatatoSend);

    if (typeof ReturnValue != "undefined") {
        if (ReturnValue == "1") {
            alert("삭제 되었습니다.");
            location.href = "SMSMsgKeepBox.aspx?SMSType=" + sTop.HidSMSType.value + "&OpenWinSMSType=" + sTop.HidOpenWinSMSType.value;
        }
        else if (ReturnValue == "100") {
            alert("로그인 해주세요.");
        }
        else {
            alert("삭제 중 오류가 발생하였습니다.");
        }
    }
}

function MsgKeepSend(item, OpenWinSMSType) {
    for (var i = 1; i < 11; i++) {
        eval("sTop.tBox_MsgKeep" + i + ".style.color = '#000000'");
    }

    var itemCtl = eval("sTop.tBox_MsgKeep" + item + ".style.color = '#FF0000'");

    var itemValue = eval("sTop.tBox_MsgKeep" + item + ".value");
    opener.document.all.tBox_Msg.value = itemValue;
    if(OpenWinSMSType == "")
    {
        OpenWinSMSType = opener.document.all.JascSMSType.value;
    }

    if (OpenWinSMSType == "SMS")
        opener.MsgBoxKeyup();
    else if (OpenWinSMSType == "LMS")
        opener.LMSMsgBoxKeyup();
    else if (OpenWinSMSType == "AD")
        opener.ADMsgBoxKeyup();
}

function LMSMsgKeepSend(item, OpenWinSMSType) {
    for (var i = 1; i < 11; i++) {
        eval("sTop.tBox_LMSMsgKeep" + i + ".style.color = '#000000'");
    }

    var itemCtl = eval("sTop.tBox_LMSMsgKeep" + item + ".style.color = '#FF0000'");

    var itemValue = eval("sTop.tBox_LMSMsgKeep" + item + ".value");
    opener.document.all.tBox_Msg.value = itemValue;
    if(OpenWinSMSType == "")
    {
        OpenWinSMSType = opener.document.all.JascSMSType.value;
    }

    if (OpenWinSMSType == "SMS")
    {
        opener.MsgBoxKeyup();
    }
    else if (OpenWinSMSType == "LMS")
    {
        opener.LMSMsgBoxKeyup();
    }
    else if (OpenWinSMSType == "AD")
    {
        opener.ADMsgBoxKeyup();
    }
}

//========================================================
// 2013-08-07 guagua SMS 90Byte 변경
//========================================================
function MsgKeepBoxSave() {
    var ActionFile, DatatoSend, ReturnValue;
    var itemValue, SMSType;

    if ((sTop.tBox_Msg.value == "") || (escape(sTop.tBox_Msg.value) == TempMsg)) {
        alert("메시지를 입력해 주세요.");
        return false;
    }

    if (parseInt(document.getElementById("MsgLength").innerHTML) <= 90) {
        SMSType = "SMS";
    } else if (parseInt(document.getElementById("MsgLength").innerHTML) > 90) {
        SMSType = "LMS";
    }
    
    ActionFile = "AjaxSMS.aspx";
    DatatoSend = "JobFlag=ParentMsgKeep&SMSType=" + SMSType + "&Msg=" + escape(sTop.tBox_Msg.value);
    ReturnValue = GetXmlHTTP(ActionFile, DatatoSend);

    if (typeof ReturnValue != "undefined") {
        if (ReturnValue == "1") {
            alert("저장 되었습니다.");
        }
        else if (ReturnValue == "100") {
            alert("로그인 해주세요.");
        }
        else if (ReturnValue == "0") {
            alert("문자보관함이 가득차서 더이상 등록할 수 없습니다.");
        }
        else {
            alert("저장 중 오류가 발생하였습니다.");
        }
    }
}

//========================================================
// 2013-08-07 guagua SMS 90Byte 변경
//========================================================
function SMSModeChange() {
    var str;
    var str_count = 0;
    var cut_count = 0;
    var str_length = sTop.tBox_Msg.value.length;

    for (var k = 0; k < str_length; k++) {
        str = sTop.tBox_Msg.value.charAt(k);

        if (escape(str).length > 4) {
            str_count += 2;
        }
        else {
            if (navigator.appVersion.indexOf("MSIE 9") > -1) {
                if (escape(str) != '%0D') {
                    str_count++;
                }
            }
            else {
                if (escape(str) == '%0A') {
                    str_count++;
                }
                else if (escape(str) == '%0D') {
                }
                else {
                    str_count++;
                }
            }
        }

        if (sTop.JascSMSType.value == "SMS")
        {
            if (str_count > 90) {
                if (escape(str).length > 4) str_count -= 2;
                else str_count--;
                sTop.tBox_Msg.value = sTop.tBox_Msg.value.substring(0, k);

                document.getElementById("Msg80").innerText = "90";
                document.getElementById("pn_LMSTooltip").style.visibility = "hidden";

                document.getElementById("MsgLength").innerHTML = str_count;

                break;
            }
        }
        else if (sTop.JascSMSType.value == "LMS")
        {
            if (str_count > 2000) {
                if (escape(str).length > 4) str_count -= 2;
                else str_count--;
                sTop.tBox_Msg.value = sTop.tBox_Msg.value.substring(0, k);

                document.getElementById("Msg80").innerText = "2000";
                document.getElementById("pn_LMSTooltip").style.visibility = "hidden";

                document.getElementById("MsgLength").innerHTML = str_count;

                break;
            }
        }
        else if (sTop.JascSMSType.value == "AD")
        {
            if (str_count > 57) {
                if (escape(str).length > 4) str_count -= 2;
                else str_count--;
                sTop.tBox_Msg.value = sTop.tBox_Msg.value.substring(0, k);

                document.getElementById("Msg80").innerText = "57";
                document.getElementById("pn_LMSTooltip").style.visibility = "hidden";

                document.getElementById("MsgLength").innerHTML = str_count;

                break;
            }
        }
    }
}

function MsgKeepClose() {
    self.window.close();    
}

function LMSChangeNoticeClose() {
    sTop.HidLMSChangeNotice.value = "Y";
    document.getElementById("pn_LMSTooltip").style.visibility = "hidden";
}

function GetRecvNo() {
    var ReturnValue;
    var strHTML = document.getElementById("Div_RecvNo").innerHTML;
    if (strHTML.length == 0) {
        return "";
    }

    if (sTop.HidTextFileName.value.length == 0) {
        var RecvNoItem = document.getElementById("Div_RecvNo").children;
        for (var i = 0; i < RecvNoItem.length; i++) {
            var MobileNo = RecvNoItem[i].children[0].innerHTML;
            var UserName = RecvNoItem[i].children[1].innerHTML;
            var ComName = RecvNoItem[i].children[2].innerHTML;

            if (i > 0)
                ReturnValue += "‡" + MobileNo + "¶" + UserName + "¶" + ComName;
            else
                ReturnValue = MobileNo + "¶" + UserName + "¶" + ComName;
        }
    }
    else {
        ReturnValue = "TextFile";
    }

    return ReturnValue;
}

//========================================================
// 2013-08-07 guagua SMS 90Byte 변경
//========================================================
function SMSSendValidate() {
    var SMSMode;
    var AryRecvNo;
    var RecvNoCount;
    var RecvNoTopOne;
    var SendSummaryRecvNoText;
    var SendSummaryReservationText;
    var SendSummaryReservationValue;
    var ActionFile, DatatoSend, ReturnValue;
    var SendPosCode, SendMoney;
    var SendMoneyText;
    var JascSMSType;
    var MaxLength = 90;;
    var MsgLength = document.getElementById("MsgLength").innerHTML;
    
    if(sTop.JascSMSType.value == "AD")
    {
        MaxLength = 49;
    }
    
    if (parseInt(MsgLength) <= MaxLength) {
        SMSMode = "SMS";
    }
    else if (parseInt(MsgLength) > MaxLength) {
        SMSMode = "LMS";
    }

    if ((escape(sTop.tBox_Msg.value) == TempMsg) || (escape(sTop.tBox_Msg.value) == LMSTempMsg) || (sTop.tBox_Msg.value == "")) {
        alert("보낼메시지를 입력하세요.");
        return false;
    }

    if (!DoCheckLang(sTop.tBox_Msg.value)) {
        return false;
    }
    
    AryRecvNo = GetRecvNo();
    if (AryRecvNo == "" || AryRecvNo == undefined) {
        alert("받을사람을 선택해 주세요.");
        return false;
    }
    
    if (AryRecvNo != "TextFile") {
        RecvNoCount = parseInt(AryRecvNo.split("‡").length);
        RecvNoTopOne = AryRecvNo.split("‡")[0].split("¶")[0];

        if (RecvNoCount > 1) {
            SendSummaryRecvNoText = RecvNoTopOne + "외 " + (RecvNoCount - 1).toString() + "건";
        }
        else {
            SendSummaryRecvNoText = RecvNoTopOne;
        }
    }
    else {
        RecvNoCount = Replace(document.getElementById("RecvNoCountText").innerHTML, ",", "");
        SendSummaryRecvNoText = "총 " + document.getElementById("RecvNoCountText").innerHTML + "건";
    }
    
    sTop.s_SendSummaryRecvNoText.value = SendSummaryRecvNoText;
    
    if (sTop.tBox_CallbackNo.value == "") {
        alert("회신번호를 입력해 주세요.");
        return false;
    }
    else 
    {
        if (!IsCallbackNo(sTop.tBox_CallbackNo.value))
        {
            alert("회신번호가 잘못 되었습니다.");
            return false;
        }
    }
    
    if (sTop.rBox_SendNow.checked) {
        SendSummaryReservationText = "즉시발송";
    } else {
        var yr = document.getElementById("ddl_ReserYear").options[document.getElementById("ddl_ReserYear").selectedIndex].value;
        var mo = document.getElementById("ddl_ReserMonth").options[document.getElementById("ddl_ReserMonth").selectedIndex].value;
        var dy = document.getElementById("ddl_ReserDay").options[document.getElementById("ddl_ReserDay").selectedIndex].value;
        var hu = document.getElementById("ddl_ReserHour").options[document.getElementById("ddl_ReserHour").selectedIndex].value;
        var mi = document.getElementById("ddl_ReserMinute").options[document.getElementById("ddl_ReserMinute").selectedIndex].value;
        
        if (mo.length == 1) mo = "0" + mo;
        if (dy.length == 1) dy = "0" + dy;
        if (hu.length == 1) hu = "0" + hu;
        if (mi.length == 1) mi = "0" + mi;
        
        SendSummaryReservationText = yr + "년 " + mo + "월 " + dy + "일 " + hu + "시 " + mi + "분";
        SendSummaryReservationValue = yr + mo + dy + hu + mi;
    }

    if (sTop.HidSendPayMethod.value != "2") {
        //SMS, LMS, MMS송신요금 반환
        ActionFile = "AjaxSMS.aspx";
        DatatoSend = "JobFlag=SetSMSSendPossible&SMSType=" + SMSMode + "&RecvNoCount=" + RecvNoCount.toString();
        ReturnValue = GetXmlHTTP(ActionFile, DatatoSend);

        if (typeof ReturnValue != "undefined") {
            var AryReturnValue = ReturnValue.split(";");
            if ((AryReturnValue[0] == "110") || (AryReturnValue[0] == "111")) {
                SendPosCode = AryReturnValue[0];
                SendMoney = AryReturnValue[1];

                if (SendPosCode == "111") {
                    SendMoneyText = "충전포인트 " + add_comma(SendMoney) + "포인트";
                }
            }
            else if (ReturnValue == "100") {
                alert("로그인 해주세요.");
                return false;
            }
            else {
                alert("발송예상요금 확인 중 오류가 발생하였습니다.");
                return false;
            }
        }
    }
    else {
        SendMoneyText = "후불 요금제";
        SendPosCode = "111"
    }
        
    if (SendPosCode != "110") {
        if (sTop.JascSMSType.value != "AD") {
            document.all.tBox_SummaryMsg.value = sTop.tBox_Msg.value;
        } else {
            var strRefusalMsg = "무료수신거부\n080-877-8208\n발신자코드" + sTop.HidSendCode.value;
            
            document.all.tBox_SummaryMsg.value = sTop.tBox_Msg.value + "\n" + strRefusalMsg;
        }
        document.getElementById("Div_SendSummary_CallbackNo").innerHTML = sTop.tBox_CallbackNo.value;
        document.getElementById("Div_SendSummary_RecvNo").innerHTML = SendSummaryRecvNoText;
        document.getElementById("Div_SendSummary_SendReservation").innerHTML = SendSummaryReservationText;
        document.getElementById("Div_SendSummary_RecvNoCount").innerHTML = add_comma(RecvNoCount.toString()) + "건";
        document.getElementById("Div_SendSummary_SendMoney").innerHTML = SendMoneyText;
        
        SendSummaryOpen();
    }
    else {
        alert("포인트가 부족합니다.");
        return false;
    }
    
    sTop.s_SMSMode.value = SMSMode;
    sTop.s_Msg.value = sTop.tBox_Msg.value;
    sTop.s_Subject.value = sTop.tBox_Subject.value;
    sTop.s_RecvNo.value = AryRecvNo;
    
    if (sTop.cBox_Overlaping.checked) {
        sTop.s_IsOverlap.value = "on";
    }
    else {
        sTop.s_IsOverlap.value = "off";
    }
    
    sTop.s_CallbackNo.value = sTop.tBox_CallbackNo.value;
    
    if (sTop.rBox_SendNow.checked) {
        sTop.s_SendReservation.value = "now";
    } else {
        sTop.s_SendReservation.value = SendSummaryReservationValue;
    }

    return false;
}


function SendSummaryOpen() {
    document.getElementById("pn_LMSTooltip").style.visibility = "hidden";
    
    document.getElementById("Div_SendSummary").style.top = 0;
    document.getElementById("Div_SendSummary").style.left = 20;
    document.getElementById("Div_SendSummary").style.visibility = "";
}

function SendSummaryClose() {
    document.getElementById("Div_SendSummary").style.visibility = "hidden";

    document.all.tBox_SummaryMsg.value = "";
    document.getElementById("Div_SendSummary_CallbackNo").innerHTML = "";
    document.getElementById("Div_SendSummary_RecvNo").innerHTML = "";
    document.getElementById("Div_SendSummary_SendReservation").innerHTML = "";
    document.getElementById("Div_SendSummary_RecvNoCount").innerHTML = "";
    document.getElementById("Div_SendSummary_SendMoney").innerHTML = "";
}

function SendSummarySubmit() {
    document.form1.method = "post";
    document.form1.action = "SMSMessageSend.aspx";
    document.form1.submit();

    document.getElementById("Div_MessageSending").style.top = 0;
    document.getElementById("Div_MessageSending").style.left = 20;
    document.getElementById("Div_MessageSending").style.visibility = "";
    document.getElementById("Div_SendSummary").style.visibility = "hidden";

    document.all.tBox_SummaryMsg.value = "";
    document.getElementById("Div_SendSummary_CallbackNo").innerHTML = "";
    document.getElementById("Div_SendSummary_RecvNo").innerHTML = "";
    document.getElementById("Div_SendSummary_SendReservation").innerHTML = "";
    document.getElementById("Div_SendSummary_RecvNoCount").innerHTML = "";
    document.getElementById("Div_SendSummary_SendMoney").innerHTML = "";
}

function AddrOpen() {
    iWidth = 696;
    iHeight = 800;

    thisX = screen.availWidth;
    thisY = screen.availHeight;

    xx = (thisX - iWidth) / 2;
    yy = (thisY - iHeight) / 2;

    sUrl = "Addr.aspx?AddrType=SMS";
    winaddr = window.open(sUrl, "Addr", "left=" + xx + ",top=" + yy + ",width=" + iWidth + ",height=" + iHeight + ", scrollbars=no,menubar=no,resizable=no");
    winaddr.focus();

    return false;
}

function GotoSMSMessage() {
    var param;
    
    param = "&NO_CUST=" + sTop.HidNoCust.value + "&NO_USER=" + sTop.HidNoUser.value + "&USER_ID=" + sTop.HidBill36524ID.value + "&PASSWORD=" + sTop.HidUserWP.value + "&UserName=" + sTop.HidLoginUserName.value + "&ComName=" + sTop.HidLoginComName.value;
    
    if(sTop.Hid_JascType.value == "LMS")
    {
        parent.location.href = "SMSSend.aspx?SMSMode=LMS&LogIn=Y" + param;
    }
    else if(sTop.Hid_JascType.value == "AD")
    {
        parent.location.href = "SMSSend.aspx?SMSMode=AD&LogIn=Y" + param;
    }
    else
    {
        parent.location.href = "SMSSend.aspx?SMSMode=SMS&LogIn=Y" + param;
    }    
}

function GotoExcelSMSMessage() {
    parent.location.href = "SMSSend.aspx?SMSMode=EXCEL";
}

function FastCalSelClick(SelectType) {

    var sTop = document.all;
    var y, m, d, yy, mm, dd;
    var strValue;

    if ((SelectType == "29") || (SelectType == "30") || (SelectType == "31") || (SelectType == "32"))
        y = eval('sTop.HidDateType' + SelectType + '.value.substring(0,4)');
    else
        y = sTop.ddl_SearchYear.value;
        
    m = eval('sTop.HidDateType' + SelectType + '.value.substring(4,6)');
    d = eval('sTop.HidDateType' + SelectType + '.value.substring(6,8)');

    if ((SelectType == "29") || (SelectType == "30") || (SelectType == "31") || (SelectType == "32"))
        yy = eval('sTop.HidDateType' + SelectType + '.value.substring(8,12)');
    else
        yy = sTop.ddl_SearchYear.value;
        
    mm = eval('sTop.HidDateType' + SelectType + '.value.substring(12,14)');
    dd = eval('sTop.HidDateType' + SelectType + '.value.substring(14,16)');
    
    sTop.tBox_StartYear.value = y;
    sTop.tBox_StartMonth.value = m;
    sTop.tBox_StartDay.value = d;

    sTop.tBox_EndYear.value = yy;
    sTop.tBox_EndMonth.value = mm;
    sTop.tBox_EndDay.value = dd;
    
    sTop.HidBeginDate.value = y + m + d;
    sTop.HidEndDate.value = yy + mm + dd;
}

function MessageSendListClick() {
    var Startyr = sTop.tBox_StartYear.value;
    var Startmo = sTop.tBox_StartMonth.value;
    var Startdy = sTop.tBox_StartDay.value;
    var Endyr = sTop.tBox_EndYear.value;
    var Endmo = sTop.tBox_EndMonth.value;
    var Enddy = sTop.tBox_EndDay.value;
    
    if (Startyr == "") {
        alert("조회기간(검색시작일)을 입력해 주세요.");
        return false;
    }
    if (Startmo == "") {
        alert("조회기간(검색시작일)을 입력해 주세요.");
        return false;
    }
    if (Startdy == "") {
        alert("조회기간(검색시작일)을 입력해 주세요.");
        return false;
    }
    if (Endyr == "") {
        alert("조회기간(검색종료일)을 입력해 주세요.");
        return false;
    }
    if (Endmo == "") {
        alert("조회기간(검색종료일)을 입력해 주세요.");
        return false;
    }
    if (Enddy == "") {
        alert("조회기간(검색종료일)을 입력해 주세요.");
        return false;
    }
    if (parseInt(Startyr + Startmo + Startdy) > parseInt(Endyr + Endmo + Enddy)) {
        alert("조회기간 검색시작일이 종료일보다 클 수 없습니다.");
        return false;
    }
    if(parseInt(sTop.HidBindEndDate.value) < parseInt(Endyr + Endmo))
    {
        alert("검색종료일자가 이번달을 초과 할 수 없습니다.");
        return false;
    }
    if (parseInt(sTop.HidLimitDate.value) > parseInt(Startyr + Startmo + Startdy)) {
        alert("전송결과는 6개월까지만 조회가 가능합니다.\n조회기간을 다시 설정하시기 바랍니다.");
        return false;
    }
    else {
        var BeginDate = Startyr + Startmo + Startdy;
        var EndDate = Endyr + Endmo + Enddy;
        var SearchValue = sTop.ddl_SearchValue.value;
        var SearchText = sTop.tBox_SearchText.value;
        
        sTop.HidBeginDate.value = BeginDate;
        sTop.HidEndDate.value = EndDate;
        sTop.HidSearchValue.value = SearchValue;
        sTop.HidSearchText.value = SearchText;
        
        return true;
    }
}

function SendResultSummaryOpen(tblKey, BulkKey, CallbackNo, SendingCount, SendCount, OverlapCount, RefusalCount, SuccessCount, FailCount, SearchBeginDate, SearchEndDate, SendType) {
    var iWidth, iHeight, thisX, thisY, xx, yy;
    var winTop;

    winTop = parent;

    iWidth = 600;
    iHeight = 820;

    thisX = winTop.document.body.clientWidth;
    thisY = winTop.document.body.clientHeight;

    xx = (thisX / 2) - (iWidth / 2)
    yy = (thisY / 2) - (iHeight / 2)

    var win_sr = window.open("MessageSendResultSummary.aspx?tblKey=" + tblKey + "&BulkKey=" + BulkKey + "&SearchBeginDate=" + SearchBeginDate + "&SearchEndDate=" + SearchEndDate + "&CallbackNo=" + CallbackNo + "&SendingCount=" + SendingCount + "&SendCount=" + SendCount + "&OverlapCount=" + OverlapCount + "&RefusalCount=" + RefusalCount + "&SuccessCount=" + SuccessCount + "&FailCount=" + FailCount + "&SendType=" + SendType, "MessageSendResultSummary", "left=" + xx + ",top=" + yy + ",width=" + iWidth + ",height=" + iHeight + ", scrollbars=no,menubar=no,resizable=yes");
    win_sr.focus();
}

function SendResultSummaryClose() {
    self.window.close();
}

function MessageSendResultView(ViewType, tblKey, BulkKey, SearchBeginDate, SearchEndDate, CallbackNo) {
    MessageSendResultSummaryFrame.location.href = "MessageSendResultSummaryDetail.aspx?ViewType=" + ViewType + "&tblKey=" + tblKey + "&BulkKey=" + BulkKey + "&SearchBeginDate=" + SearchBeginDate + "&SearchEndDate=" + SearchEndDate + "&CallbackNo=" + CallbackNo;
    return false;
}

function SendListDetailMouseOver(OverName) {
    document.getElementById(OverName).style.backgroundColor = "#f8f8f8";
    return false;
}

function SendListDetailMouseOut(OutName) {
    document.getElementById(OutName).style.backgroundColor = "#ffffff";
    return false;
}

function SMSGotoMenu(item) {
    if (item != "EXCEL")
        location.href = "SMSSend.aspx?SMSMode=" + item;
    else
    {
       // location.href = "SMSInfomyLicenseFirst.html";
    }
}

function SMSGotoMenu2(item) {
    var img_title = document.getElementById("img_SMSTypeTitle");
    var param;

    param = "?UserName=" + sTop.HidLoginUserName.value + "&ComName=" + sTop.HidLoginComName.value + "&SendPayMethod=" + sTop.HidSendPayMethod.value;

    if(item == "SMS")
    {
        img_title.src = "../Images/CloudSMS/sms_short_InfoTitle.gif";
        document.frames("Bill36524SMS").location.href = "SMSMessage.aspx" + param;
        document.getElementById("Div_Spam").style.display = "none";
    }
    else if (item == "LMS")
    {
        img_title.src = "../Images/CloudSMS/sms_long_InfoTitle.gif";
        document.frames("Bill36524SMS").location.href = "LMSMessage.aspx" + param;
        document.getElementById("Div_Spam").style.display = "none";
    }
    else if(item == "AD")
    {
        img_title.src = "../Images/CloudSMS/sms_ad_InfoTitle.gif";
        document.frames("Bill36524SMS").location.href = "ADMessage.aspx" + param;
        document.getElementById("Div_Spam").style.display = "";
    }
    else if(item == "EXCEL")
    {
        img_title.src = "../Images/CloudSMS/sms_excel_InfoTitle.gif";
        document.frames("Bill36524SMS").location.href = "SMSLicenseFirst.aspx" + param;
        document.getElementById("Div_Spam").style.display = "none";
    }
}








//엑셀보내기 메시지박스
//========================================================
// 2013-08-07 guagua SMS 90Byte 변경
//========================================================
function MsgBoxKeyup_Excel() {
    var str;
    var str_count = 0;
    var cut_count = 0;
    var smslen = 90;
    var lmslen = 2000;
    var IsPass = 0;
    var str_tBox = sTop.tBox_Msg.value;
    var str_length = sTop.tBox_Msg.value.length;
    var strSub_tBox;
    var strSub_length;
    
    strSub_tBox = str_tBox.replace(new RegExp("<#회사명#>|<#담당자#>|<#1#>|<#2#>|<#3#>", "gi"), "");
    strSub_length = strSub_tBox.length;
    
    for (k = 0; k < strSub_length; k++) 
    {
        str = strSub_tBox.charAt(k);

        if (escape(str).length > 4) {
            str_count += 2;
        }
        else {
            if (navigator.appVersion.indexOf("MSIE 9") > -1) {
                if (escape(str) != '%0D') {
                    str_count++;
                }
            }
            else {
                if (escape(str) == '%0A') {
                    str_count++;
                }
                else if (escape(str) == '%0D') {
                }
                else {
                    str_count++;
                }
            }
        }
        
        if((smslen < str_count) && (lmslen >= str_count))
        {
            if(document.getElementById("pn_LMSTooltip").style.visibility != "")
            {
                if(sTop.HidLMSChangeNotice.value != "Y")
                {
                    //document.getElementById("pn_LMSTooltip").style.visibility = "";
                    //LMSTooltip();
                }
                
                //LMS상태로 전환
                document.getElementById("Msg80").innerText = "2000";
                document.getElementById("Msg80Right").innerText = "2000";
                
                document.getElementById("tBox_Msg").cols = "25";
                document.getElementById("tBox_Msg").className = "LMSMsgBox";
            }
        }
        else if(str_count <= smslen)
        {
            //SMS상태로 전화
            IsPass = 0;
            document.getElementById("Msg80").innerText = "90";
            document.getElementById("pn_LMSTooltip").style.visibility = "hidden";
            document.getElementById("tBox_Msg").clos = "20";
            document.getElementById("tBox_Msg").className ="MsgBox";
                
        }
        else if (str_count > lmslen) {
            alert("2000바이트 이내에서 작성할 수 있습니다.");
            if (escape(str).length > 4) str_count -= 2;
            else str_count--;
            sTop.tBox_Msg.value = sTop.tBox_Msg.value.substring(0, k + (str_length - strSub_length));
            break;
        }
    }

    document.getElementById("MsgLength").innerHTML = str_count;
}

//엑셀보내기 미리보기 메세지박스
//========================================================
// 2013-08-07 guagua SMS 90Byte 변경
//========================================================
function MsgBox_Excel_Replace(s)
{
    var str;
    var intRetValue = 1;
    var str_count = 0;
    var cut_count = 0;
    var smslen = 90;
    var lmslen = 2000;
    var IsPass = 0;
    var str_Length = s.length;
    
    var tBox = document.getElementById("tBox_Msg");
    var tBox_Right = document.getElementById("tBox_Right");
    
    for(k = 0; k < str_Length; k++)
    {
        str = s.charAt(k);

        if (escape(str).length > 4) {
            str_count += 2;
        }
        else {
            if (navigator.appVersion.indexOf("MSIE 9") > -1) {
                if (escape(str) != '%0D') {
                    str_count++;
                }
            }
            else {
                if (escape(str) == '%0A') {
                    str_count++;
                }
                else if (escape(str) == '%0D') {
                }
                else {
                    str_count++;
                }
            }
        }
        
        if((smslen < str_count) && (lmslen >= str_count))
        {
            if(document.getElementById("pn_LMSTooltip").style.visibility != "")
            {
                if(sTop.HidLMSChangeNotice.value != "Y")
                {
                    //document.getElementById("pn_LMSTooltip").style.visibility = "";
                    //LMSTooltip();
                }
                
                //LMS상태로 전환
                document.getElementById("Msg80").innerText = "2000";
                document.getElementById("Msg80Right").innerText = "2000";
                
                tBox.cols = "25";
                tBox.className = "LMSMsgBox";
                tBox_Right.cols = "25";
                tBox_Right.className = "LMSMsgBox";                
            }
        }
        else if(str_count <= smslen)
        {
            //SMS상태로 전화
            IsPass = 0;
            document.getElementById("Msg80").innerText = "90";
            document.getElementById("Msg80Right").innerText = "90";
            document.getElementById("pn_LMSTooltip").style.visibility = "hidden";
            
            tBox.cols = "20";
            tBox.className = "MsgBox";
            tBox_Right.cols = "20";
            tBox_Right.className = "LMSMsgBox";
                
        }
        else if (str_count > lmslen) {
            alert("2000바이트 이내에서 작성할 수 있습니다.");
            if (escape(str).length > 4) str_count -= 2;
            else str_count--;
            sTop.tBox_Right.value = s.substring(0, k);
            intRetValue = -1;
            break;
        }
    }
    
    if(intRetValue == 1)
    {
        sTop.tBox_Right.value = s;
    }
    
    document.getElementById("MsgLengthRight").innerHTML = str_count;
    return intRetValue;
}

function SpecialChar_Excel() {
    var pn_specialcharacter = document.getElementById("Div_SpecialCharacter");

    if (pn_specialcharacter != null) {
        if (pn_specialcharacter.style.visibility == "hidden") {
            var tBoxPos = getBounds(document.getElementById("img_specialcharacter"));

            pn_specialcharacter.style.top = (tBoxPos.top - 150) + "px";
            pn_specialcharacter.style.left = (tBoxPos.left + 170) + "px";
            pn_specialcharacter.style.zIndex = "1";

            pn_specialcharacter.style.visibility = "";
        }
        else {
            pn_specialcharacter.style.visibility = "hidden";
        }
    }
}

//엑셀보내기 특수문자
function SpecialCharacterAdd_Excel(s) {
    
    if (escape(sTop.tBox_Msg.value) == TempMsg) {
            sTop.tBox_Msg.value = s;
    }
    else {
            sTop.tBox_Msg.value = sTop.tBox_Msg.value + s;
    }

    if (sTop.JascSMSType.value == "SMS") {
        MsgBoxKeyup_Excel();
    }
}

//엑셀보내기 바꿀문자 입력
function Add_ReplaceCharacter(s)
{
    if (escape(sTop.tBox_Msg.value) == TempMsg) {
            sTop.tBox_Msg.value = s;
    }
    else {
            sTop.tBox_Msg.value = sTop.tBox_Msg.value + s;
    }
    
    if (sTop.JascSMSType.value == "SMS") {
        MsgBoxKeyup_Excel();
    }
}

//엑셀보내기 문자보관함 열기 1
function MsgKeepBoxView_Excel() {
    var iWidth, iHeight, thisX, thisY, xx, yy;
    var winTop;
    var SMSType1, SMSType2;

    SMSType1 = sTop.JascSMSType.value;
    SMSType2 = sTop.JascSMSType.value;

    winTop = parent;
    
    if(SMSType1 == "SMS")
    {
        iWidth = 717;
        iHeight = 603;
    }
    else
    {
        iWidth = 747;
        iHeight = 852;  
    }
    

    thisX = winTop.document.body.clientWidth;
    //thisY = winTop.document.body.clientHeight;
    thisY = 852;

    xx = (thisX / 2) - (iWidth / 2)
    yy = (thisY / 2) - (iHeight / 2)

    var win_SMSMsgKeepBox = window.open("SMSMsgKeepBox.aspx?SMSType=" + SMSType1 + "&OpenWinSMSType=" + SMSType2 + "&OpenerPageType=Excel", "SMSMsgKeepBox", "left=" + xx + ",top=" + yy + ",width=" + iWidth + ",height=" + iHeight + ", scrollbars=no,menubar=no,resizable=no");
    win_SMSMsgKeepBox.focus();
}

//엑셀보내기 문자보관함 열기 2
function MsgKeepSend_Excel(item, OpenWinSMSType) {
    var itemValue = eval("sTop.tBox_MsgKeep" + item + ".value");
    opener.document.all.tBox_Msg.value = itemValue;
    
    opener.MsgBoxKeyup_Excel();
}

//엑셀보내기 미리보기 버튼 클릭
function tBox_SMSPreView()
{
    var tBox_Msg;
    var tBox_Right;
    var s;
    var strReplace = "";
    var AX;
    var arrFixed = new Array("<#회사명#>", "<#담당자#>", "", "<#1#>", "<#2#>", "<#3#>");
    var Arr1 = new Array();
    
    tBox_Msg = document.getElementById("tBox_Msg");
    tBox_Right = document.getElementById("tBox_Right");
    
    if (escape(sTop.tBox_Msg.value) == TempMsg) {
            alert("메세지를 입력해 주세요.");
            return false;
    }
    else {
            strReplace = sTop.tBox_Msg.value;
    }
    
    AX = document.getElementById("FlexGridReplace");
    if(AX.AXPreview() == -1)
    {
        s= "";
    }
    else
    {
        s = window.clipboardData.getData('Text');
    }
    
    window.clipboardData.clearData();
    
    Arr1 = s.split("\t");

    for (var i = 0; i < arrFixed.length; i++)
    
    {
        if(i == 2)
            continue;
        
        if(Arr1[i] != undefined)
            strReplace = strReplace.replace(new RegExp(arrFixed[i], "gi"), Arr1[i]);    
        else
            strReplace = strReplace.replace(new RegExp(arrFixed[i], "gi"), "");    
    }
    
    MsgBox_Excel_Replace(strReplace);
}

//엑셀보내기 메뉴 선택
function ExcelSend_TitleChange(srcName)
{
    if (srcName != undefined && srcName.length > 0)
    {
        location.href = srcName + ".aspx?SendPayMethod=" + sTop.HidSendPayMethod.value;
    }   
}

//엑셀보내기 수신번호 체크
function ExcelMobilNoValidation(mobilNo)
{
    if (mobilNo.length < 10) {
        alert("잘못된 휴대폰 번호 입니다. [" + mobilNo + "]\n확인 후 다시 입력해 주세요.");
        return false;
    }
    else if (mobilNo.substring(0, 3) != "010" && mobilNo.substring(0, 3) != "011" && mobilNo.substring(0, 3) != "016" && mobilNo.substring(0, 3) != "017" && mobilNo.substring(0, 3) != "018" && mobilNo.substring(0, 3) != "019") {
        alert("잘못된 휴대폰 번호 입니다. [" + mobilNo + "]\n확인 후 다시 입력해 주세요.");
        return false;
    }
    else if (!IsMobileNo(mobilNo)) {
        alert("잘못된 휴대폰 번호 입니다. [" + mobilNo + "]\n휴대폰 번호는 숫자, - 만 입력할 수 있습니다.\n\n확인 후 다시 입력해 주세요.");
        return false;
    }
    
    return true;
}

//엑셀보내기 주소록 불러오기
function Excel_AddrOpen() {
    iWidth = 696;
    iHeight = 800;

    thisX = screen.availWidth;
    thisY = screen.availHeight;

    xx = (thisX - iWidth) / 2;
    yy = (thisY - iHeight) / 2;

    sUrl = "Addr.aspx?AddrType=SMS";
    winaddr = window.open(sUrl, "Addr", "left=" + xx + ",top=" + yy + ",width=" + iWidth + ",height=" + iHeight + ", scrollbars=no,menubar=no,resizable=no");
    winaddr.focus();
    
    return false;
}

//엑셀보내기 전송하기체크
//========================================================
// 2013-08-07 guagua SMS 90Byte 변경
//========================================================
function Excel_SMSSendValidate() {
    var SMSMode;
    var RecvNoCount;
    var RecvNoTopOne;
    var SendSummaryRecvNoText;
    var SendSummaryReservationText;
    var SendSummaryReservationValue;
    var SendPosCode, SendMoney;
    
    var SendSummary_Msg;
    
    var AXObject;
    var ClipData = "";
    var Arr1 = new Array();
    var Arr2 = new Array();
    
    var SendNo;
    var SendMessage = "";
    var SendSubMessage = "";
    var MsgLength;
    var cntSMS = 0;
    var cntLMS = 0;
    
    var intResult;
    var bResult;
    var bIsDataExist;
    
    if ((escape(sTop.tBox_Msg.value) == TempMsg) || (sTop.tBox_Msg.value == "")) {
        alert("보낼메시지를 입력하세요.");
        return false;
    }
     
    if (sTop.tBox_CallbackNo.value == "") {
        alert("회신번호를 입력해 주세요.");
        return false;
    }
    else 
    {
        if (!IsCallbackNo(sTop.tBox_CallbackNo.value))
        {
            alert("회신번호가 잘못 되었습니다.");
            return false;
        }
    }
    
    AXObject = document.getElementById("FlexGridReplace");
    intResult = AXObject.AXSaveToClipboard();
    
    if(intResult != 1)
    {
        alert("데이터 읽기 실패!");
        return false;
    }
    
    ClipData = window.clipboardData.getData('Text');
    window.clipboardData.clearData();
    
    
    Arr1 = ClipData.split("\r\n");
    
    for(var i = 0; i < Arr1.length; i++)
    {
        Arr2 = Arr1[i].split("\t");
        bIsDataExist = false;
        SendSubData = "";
        
        if(Arr2.length != 6)
        {
            continue;
        }
        
        for(var j = 0; j < Arr2.length; j++)
        {
            if(Arr2[j].length > 0)
            {
                bIsDataExist = true;
                break;
            }
        }
        
        if(bIsDataExist)
        {
            //전화번호 유효성 검사
            bResult = ExcelMobilNoValidation(Arr2[2]);           
            
            if(!bResult)
            {
                AXObject.AXShowCell(i);
                return false;
            }
            
            SendNo = Arr2[2];
            SendSubMessage = Excel_SMSSendReplace(Arr2);
            MsgLength = Excel_SendMsgLength(SendSubMessage);
            if(MsgLength == -1)
            {
                AXObject.AXShowCell(i);
                return false;
            }
            
            if(MsgLength <= 90)
            {
                cntSMS++;
            }
            else if(MsgLength > 90)
            {
                cntLMS++;
            }
            
            if(SendMessage.length > 0)
            {
                SendMessage += "‡" + Arr2[2] + "¶" + Arr2[1] + "¶" + Arr2[0] + "¶" + SendSubMessage;
            }
            else
            {
                SendMessage = Arr2[2] + "¶" + Arr2[1] + "¶" + Arr2[0] + "¶" + SendSubMessage;
                SendSummary_Msg = SendSubMessage;
            }   
        }
    }
    
    if(SendMessage.length <= 0)
    {
        alert("데이터를 입력해 주세요.!");
        return false;
    }
    
    RecvNoCount = parseInt(SendMessage.split("‡").length);
    RecvNoTopOne = SendMessage.split("‡")[0].split("¶")[0];
    SendSummaryRecvNoText = "총 " + RecvNoCount.toString() + "건";
    if (RecvNoCount > 1) {
        SendSummaryRecvNoText = RecvNoTopOne + "외 " + (RecvNoCount - 1).toString() + "건";
    }
    else {
        SendSummaryRecvNoText = RecvNoTopOne;
    }
    
    if (sTop.rBox_SendNow.checked) {
        SendSummaryReservationText = "즉시발송";
    } else {
        var yr = document.getElementById("ddl_ReserYear").options[document.getElementById("ddl_ReserYear").selectedIndex].value;
        var mo = document.getElementById("ddl_ReserMonth").options[document.getElementById("ddl_ReserMonth").selectedIndex].value;
        var dy = document.getElementById("ddl_ReserDay").options[document.getElementById("ddl_ReserDay").selectedIndex].value;
        var hu = document.getElementById("ddl_ReserHour").options[document.getElementById("ddl_ReserHour").selectedIndex].value;
        var mi = document.getElementById("ddl_ReserMinute").options[document.getElementById("ddl_ReserMinute").selectedIndex].value;

        if (mo.length == 1) mo = "0" + mo;
        if (dy.length == 1) dy = "0" + dy;
        if (hu.length == 1) hu = "0" + hu;
        if (mi.length == 1) mi = "0" + mi;

        SendSummaryReservationText = yr + "년 " + mo + "월 " + dy + "일 " + hu + "시 " + mi + "분";
        SendSummaryReservationValue = yr + mo + dy + hu + mi;
    }

    //SMS, LMS, MMS송신요금 반환
    if (sTop.HidSendPayMethod.value != "2") {
        ActionFile = "AjaxSMS.aspx";
        DatatoSend = "JobFlag=SetExcelSMSSendPossible&SMSCount=" + cntSMS.toString() + "&LMSCount=" + cntLMS.toString();
        ReturnValue = GetXmlHTTP(ActionFile, DatatoSend);

        if (typeof ReturnValue != "undefined") {
            var AryReturnValue = ReturnValue.split(";");
            if ((AryReturnValue[0] == "110") || (AryReturnValue[0] == "111")) {
                SendPosCode = AryReturnValue[0];
                SendMoney = AryReturnValue[1];

                if (SendPosCode == "111") {
                    SendMoneyText = "충전포인트 " + add_comma(SendMoney) + "포인트";
                }
            }
            else if (ReturnValue == "100") {
                alert("로그인 해주세요.");
                return false;
            }
            else {
                alert("발송예상요금 확인 중 오류가 발생하였습니다.");
                return false;
            }
        }
    }
    else {
        SendMoneyText = "후불 요금제";
        SendPosCode = "111";
    }

    if (SendPosCode != "110") {
        document.all.tBox_SummaryMsg.value = SendSummary_Msg;
        
        document.getElementById("Div_SendSummary_CallbackNo").innerHTML = sTop.tBox_CallbackNo.value;
        document.getElementById("Div_SendSummary_RecvNo").innerHTML = SendSummaryRecvNoText;
        document.getElementById("Div_SendSummary_SendReservation").innerHTML = SendSummaryReservationText;
        document.getElementById("Div_SendSummary_RecvNoCount").innerHTML = add_comma(RecvNoCount.toString()) + "건";
        document.getElementById("Div_SendSummary_SendMoney").innerHTML = SendMoneyText;
        window.scrollTo(0,0);
        Excel_SendSummaryOpen();
    }
    else {
//        document.all.tBox_LackMsg.value = SendSummary_Msg;
//        
//        document.getElementById("Div_Lack_CallbackNo").innerHTML = sTop.tBox_CallbackNo.value;
//        document.getElementById("Div_Lack_RecvNo").innerHTML = SendSummaryRecvNoText;
//        document.getElementById("Div_Lack_SendReservation").innerHTML = SendSummaryReservationText;
//        document.getElementById("Div_Lack_RecvNoCount").innerHTML = add_comma(RecvNoCount.toString()) + "건";
//        document.getElementById("Div_Lack_SendMoney").innerHTML = SendMoneyText;

//        Excel_BalanceLackOpen();
        
        alert("포인트가 부족합니다.");
        return false;
    }
    
    
    sTop.s_RecvNo_Msg.value = SendMessage;
    if (sTop.cBox_Overlaping.checked) {
        sTop.s_IsOverlap.value = "on";
    }
    else {
        sTop.s_IsOverlap.value = "off";
    }
    sTop.s_CallbackNo.value = sTop.tBox_CallbackNo.value;
    if (sTop.rBox_SendNow.checked) {
        sTop.s_SendReservation.value = "now";
    } else {
        sTop.s_SendReservation.value = SendSummaryReservationValue;
    }
    
    return false;
}

//엑셀보내기 메세지 변환
function Excel_SMSSendReplace(arrData)
{
    var tBox_Msg;
    var strReplace;
    var arrFixed = new Array("<#회사명#>", "<#담당자#>", "", "<#1#>", "<#2#>", "<#3#>");
    
    tBox_Msg = document.getElementById("tBox_Msg");
    strReplace = tBox_Msg.value;
    
    for(var i = 0; i < arrFixed.length; i++)
    {
        if(i == 2)
            continue;
        
        if(arrData[i] != undefined)
            strReplace = strReplace.replace(new RegExp(arrFixed[i], "gi"), arrData[i]);    
        else
            strReplace = strReplace.replace(new RegExp(arrFixed[i], "gi"), "");    
    }
    
    return strReplace;
}

//엑셀보내기 변환된 메세지 바이트계산
function Excel_SendMsgLength(s)
{
    var str;
    var str_count = 0;
    var lmslen = 2000;
    var str_Length = s.length;
    
    for(var k = 0; k < str_Length; k++)
    {
        str = s.charAt(k);
        if (escape(str).length > 4) {
            str_count += 2;
        }
        else {
            if (navigator.appVersion.indexOf("MSIE 9") > -1) {
                if (escape(str) != '%0D') {
                    str_count++;
                }
            }
            else {
                if (escape(str) == '%0A') {
                    str_count++;
                }
                else if (escape(str) == '%0D') {
                }
                else {
                    str_count++;
                }
            }
        }
    }
        
    if (str_count > lmslen) {
        alert("최대 2000바이트 이내에서 작성할 수 있습니다.");
        str_count = -1;
    }
    
    return str_count;
}

//엑셀보내기 회신번호불러오기 창 띄우기
function Excel_CallbackNoView() {
    document.getElementById("Div_CallbackNo").innerHTML = CallbackNoFrame.document.getElementById("Div_CallbackNoFrame").innerHTML;

    var pn_CallbackNo = document.getElementById("Div_CallbackNo");
    

    if (pn_CallbackNo != null) {
        if (pn_CallbackNo.style.visibility == "hidden") {
            var tBoxPos = getBounds(document.getElementById("Img_CallbackNo"));

            pn_CallbackNo.style.top = (tBoxPos.top - 90) + "px";
            pn_CallbackNo.style.left = (tBoxPos.left - 240) + "px";
            pn_CallbackNo.style.zIndex = "1";

            pn_CallbackNo.style.visibility = "";
        } else {
            pn_CallbackNo.style.visibility = "hidden";
        }
    }
}

//엑셀보내기 발송전 화면
function Excel_SendSummaryOpen() {
    
    document.getElementById("Div_SendSummary").style.top = 0;
    document.getElementById("Div_SendSummary").style.left = 0;
    document.getElementById("Div_SendSummary").style.visibility = "";
    document.getElementById("div_SmsGrid").style.visibility = "hidden";
}

//엑셀보내기 발송전 화면 닫기
function Excel_SendSummaryClose() {
    document.getElementById("Div_SendSummary").style.visibility = "hidden";

    document.all.tBox_SummaryMsg.value = "";
    document.getElementById("Div_SendSummary_CallbackNo").innerHTML = "";
    document.getElementById("Div_SendSummary_RecvNo").innerHTML = "";
    document.getElementById("Div_SendSummary_SendReservation").innerHTML = "";
    document.getElementById("Div_SendSummary_RecvNoCount").innerHTML = "";
    document.getElementById("Div_SendSummary_SendMoney").innerHTML = "";
    
    document.getElementById("div_SmsGrid").style.visibility = "";
}

//엑셀보내기 전송
function Excel_SendSummarySubmit() {
    document.form1.method = "post";
    document.form1.action = "ExcelMessageSend.aspx";
    document.form1.submit();

    document.getElementById("Div_MessageSending").style.top = 0;
    document.getElementById("Div_MessageSending").style.left = 0;
    document.getElementById("Div_MessageSending").style.visibility = "";
    document.getElementById("Div_SendSummary").style.visibility = "hidden";

    document.all.tBox_SummaryMsg.value = "";
    document.getElementById("Div_SendSummary_CallbackNo").innerHTML = "";
    document.getElementById("Div_SendSummary_RecvNo").innerHTML = "";
    document.getElementById("Div_SendSummary_SendReservation").innerHTML = "";
    document.getElementById("Div_SendSummary_RecvNoCount").innerHTML = "";
    document.getElementById("Div_SendSummary_SendMoney").innerHTML = "";
}

//엑셀보내기 전체선택
function AXSMS_SelectAll(obj)
{
    var AX;
    
    AX = document.getElementById(obj);
    
    AX.AXSelectAll();
}

//엑셀보내기 잘라내기
function AXSMS_SelectCut(obj)
{
    
    var AX;
    
    AX = document.getElementById(obj);
    
    AX.AXSelectCut();
    
}

//엑셀보내기 복사
function AXSMS_SelectCopy(obj)
{
    
    var AX;
    
    AX = document.getElementById(obj);
    
    AX.AXSelectCopy();
    
}

//엑셀보내기 붙여넣기
function AXSMS_SelectPaste(obj)
{
    
    var AX;
    
    AX = document.getElementById(obj);
    
    AX.AXPaste();
    
}

//엑셀보내기 삭제
function AXSMS_SelectRemove(obj)
{
    
    var AX;
    
    AX = document.getElementById(obj);
    
    AX.AXSelectRemove();
    
}

//엑셀보내기 전체삭제
function AXSMS_AllRemove(obj)
{
    
    var AX;
    
    AX = document.getElementById(obj);
    
    AX.AXAllRemove();
    
}


//엑셀보내기 : 엑셀파일 불러오기 오픈
function SMSExcelSendOpen(excelType) {
    var iWidth, iHeight, thisX, thisY, xx, yy;
    var winTop;

    winTop = parent;

    iWidth = 555;
    iHeight = 538;

    thisX = winTop.document.body.clientWidth;
    thisY = winTop.document.body.clientHeight;

    xx = (thisX / 2) - (iWidth / 2)
    yy = (thisY / 2) - (iHeight / 2)
    var win = window.open("SMSExcelSend.aspx?OpenWinExcelType="+ excelType, "SMSExcelSend", "left=" + xx + ",top=" + yy + ",width=" + iWidth + ",height=" + iHeight + ", scrollbars=no,menubar=no,resizable=no");
    win.focus();
}

//엑셀보내기 : 엑셀파일 불러오기 결과
function ExcelFileAddResult(FileName) {
    var strHTML, UniqKey, DivName, strInnerHTML;
    var AX;
    
    document.focus();
    
    if(FileName != undefined && FileName.length > 0)
    {
        AX = document.getElementById("FlexGridReplace");
        AX.AXLoadFromExcelFile(FileName);
    }    
}

//엑셀보내기 : 엑셀파일 불러오기 닫기
function SMSExcelSendClose() {
    self.window.close();
}

//엑셀보내기 : 엑셀파일 불러오기 확인
function SMSExcelSendOK(excelType) {
    var filepath;
    var fileExt; 
    var Arr = new Array();
    
    filepath = document.getElementById("fu_SMSExcel");
    
    if (filepath.value == "") {
        alert("파일을 선택해 주세요.");
        filepath.focus();
        return false;
    }
    else
    {
        Arr = filepath.value.split(".");
        
        if(Arr[Arr.length - 1] != "xls" && Arr[Arr.length - 1] != "xlsx")
        {
            alert("Excel 파일(xls, xlsx)만 읽어올 수 있습니다.");
            location.href = "SMSExcelSend.aspx?OpenWinExcelType="+ excelType;
            filepath.focus();
            return false;
        }
    }   
    
    opener.ExcelFileAddResult(filepath.value);
    self.window.close();
    return true;
}

//엑셀보내기 전체내용 수정 - 전송하기체크
//========================================================
// 2013-08-07 guagua SMS 90Byte 변경
//========================================================
function Excel_SMSSendValidate_Multi() {
    var SMSMode;
    var RecvNoCount;
    var RecvNoTopOne;
    var SendSummaryRecvNoText;
    var SendSummaryReservationText;
    var SendSummaryReservationValue;
    var SendPosCode, SendMoney;
    
    var SendSummary_Msg;
    
    var AXObject;
    var ClipData = "";
    var Arr1 = new Array();
    var Arr2 = new Array();
    
    var SendNo;
    var SendMessage = "";
    var SendSubMessage = "";
    var MsgLength = 0;
    var cntSMS = 0;
    var cntLMS = 0;
    
    var intResult;
    var bResult;
    var bIsDataExist;
     
    if (sTop.tBox_CallbackNo.value == "") {
        alert("회신번호를 입력해 주세요.");
        return false;
    }
    else 
    {
        if (!IsCallbackNo(sTop.tBox_CallbackNo.value))
        {
            alert("회신번호가 잘못 되었습니다.");
            return false;
        }
    }
    
    AXObject = document.getElementById("FlexGridReplace");
    intResult = AXObject.AXSaveToClipboard();
    
    if(intResult != 1)
    {
        alert("데이터 읽기 실패!");
        return false;
    }
    
    ClipData = window.clipboardData.getData('Text');
    window.clipboardData.clearData();
    
    
    Arr1 = ClipData.split("\r\n");
    
    for(var i = 0; i < Arr1.length; i++)
    {
        Arr2 = Arr1[i].split("\t");
        bIsDataExist = false;
        SendSubData = "";
        
        if(Arr2.length != 3)
        {
            continue;
        }
        
        for(var j = 0; j < Arr2.length; j++)
        {
            if(Arr2[j].length > 0)
            {
                bIsDataExist = true;
                break;
            }
        }
        
        if(bIsDataExist)
        {
            //전화번호 유효성 검사
            bResult = ExcelMobilNoValidation(Arr2[1]);           
            
            if(!bResult)
            {
                AXObject.AXShowCell(i);
                return false;
            }
            
            SendNo = Arr2[1];
            SendSubMessage = Arr2[2];
            MsgLength = Excel_SendMsgLength(SendSubMessage);
            if(MsgLength == -1)
            {
                AXObject.AXShowCell(i);
                return false;
            }
            
            if(MsgLength <= 90)
            {
                cntSMS++;
            }
            else if(MsgLength > 90)
            {
                cntLMS++;
            }
            
            if(SendMessage.length > 0)
            {
                SendMessage += "‡" + Arr2[1] + "¶" + Arr2[0] + "¶" + "¶" + SendSubMessage;
            }
            else
            {
                SendMessage = Arr2[1] + "¶" + Arr2[0] + "¶" + "¶" + SendSubMessage;
                SendSummary_Msg = SendSubMessage;
            }   
        }
    }

    if(SendMessage.length <= 0)
    {
        alert("데이터를 입력해 주세요.!");
        return false;
    }
    
    RecvNoCount = parseInt(SendMessage.split("‡").length);
    RecvNoTopOne = SendMessage.split("‡")[0].split("¶")[0];
    if (RecvNoCount > 1) {
        SendSummaryRecvNoText = RecvNoTopOne + "외 " + (RecvNoCount - 1).toString() + "건";
    }
    else {
        SendSummaryRecvNoText = RecvNoTopOne;
    }
    
    if (sTop.rBox_SendNow.checked) {
        SendSummaryReservationText = "즉시발송";
    } else {
        var yr = document.getElementById("ddl_ReserYear").options[document.getElementById("ddl_ReserYear").selectedIndex].value;
        var mo = document.getElementById("ddl_ReserMonth").options[document.getElementById("ddl_ReserMonth").selectedIndex].value;
        var dy = document.getElementById("ddl_ReserDay").options[document.getElementById("ddl_ReserDay").selectedIndex].value;
        var hu = document.getElementById("ddl_ReserHour").options[document.getElementById("ddl_ReserHour").selectedIndex].value;
        var mi = document.getElementById("ddl_ReserMinute").options[document.getElementById("ddl_ReserMinute").selectedIndex].value;

        if (mo.length == 1) mo = "0" + mo;
        if (dy.length == 1) dy = "0" + dy;
        if (hu.length == 1) hu = "0" + hu;
        if (mi.length == 1) mi = "0" + mi;

        SendSummaryReservationText = yr + "년 " + mo + "월 " + dy + "일 " + hu + "시 " + mi + "분";
        SendSummaryReservationValue = yr + mo + dy + hu + mi;
    }

    //SMS, LMS, MMS송신요금 반환
    if (sTop.HidSendPayMethod.value != "2") {
        ActionFile = "AjaxSMS.aspx";
        DatatoSend = "JobFlag=SetExcelSMSSendPossible&SMSCount=" + cntSMS.toString() + "&LMSCount=" + cntLMS.toString();
        ReturnValue = GetXmlHTTP(ActionFile, DatatoSend);

        if (typeof ReturnValue != "undefined") {
            var AryReturnValue = ReturnValue.split(";");
            if ((AryReturnValue[0] == "110") || (AryReturnValue[0] == "111")) {
                SendPosCode = AryReturnValue[0];
                SendMoney = AryReturnValue[1];

                if (SendPosCode == "111") {
                    SendMoneyText = "충전포인트 " + add_comma(SendMoney) + "포인트";
                }
            }
            else if (ReturnValue == "100") {
                alert("로그인 해주세요.");
                return false;
            }
            else {
                alert("발송예상요금 확인 중 오류가 발생하였습니다.");
                return false;
            }
        }
    }
    else {
        SendMoneyText = "후불 요금제";
        SendPosCode = "111";
    }    

    if (SendPosCode != "110") {
        document.all.tBox_SummaryMsg.value = SendSummary_Msg;
        
        document.getElementById("Div_SendSummary_CallbackNo").innerHTML = sTop.tBox_CallbackNo.value;
        document.getElementById("Div_SendSummary_RecvNo").innerHTML = SendSummaryRecvNoText;
        document.getElementById("Div_SendSummary_SendReservation").innerHTML = SendSummaryReservationText;
        document.getElementById("Div_SendSummary_RecvNoCount").innerHTML = add_comma(RecvNoCount.toString()) + "건";
        document.getElementById("Div_SendSummary_SendMoney").innerHTML = SendMoneyText;
        window.scrollTo(0,0);
        Excel_SendSummaryOpen();
    }
    else {
//        document.all.tBox_LackMsg.value = SendSummary_Msg;
//        
//        document.getElementById("Div_Lack_CallbackNo").innerHTML = sTop.tBox_CallbackNo.value;
//        document.getElementById("Div_Lack_RecvNo").innerHTML = SendSummaryRecvNoText;
//        document.getElementById("Div_Lack_SendReservation").innerHTML = SendSummaryReservationText;
//        document.getElementById("Div_Lack_RecvNoCount").innerHTML = add_comma(RecvNoCount.toString()) + "건";
//        document.getElementById("Div_Lack_SendMoney").innerHTML = SendMoneyText;

//        Excel_BalanceLackOpen();
        
        alert("포인트가 부족합니다.");
        return false;
    }
    
    
    sTop.s_RecvNo_Msg.value = SendMessage;
    if (sTop.cBox_Overlaping.checked) {
        sTop.s_IsOverlap.value = "on";
    }
    else {
        sTop.s_IsOverlap.value = "off";
    }
    sTop.s_CallbackNo.value = sTop.tBox_CallbackNo.value;
    if (sTop.rBox_SendNow.checked) {
        sTop.s_SendReservation.value = "now";
    } else {
        sTop.s_SendReservation.value = SendSummaryReservationValue;
    }
    
    return false;
}

function excelSend_HelpOpen(item) 
{
    var iWidth, iHeight, thisX, thisY, xx, yy;
    var OpenFile;

    if (item == "ExcelMessage")
        OpenFile = "ExcelMessageHelp.html";
    else
        OpenFile = "ExcelMessageMultiHelp.html";

    iWidth = 750;
    iHeight = 850;

    thisX = window.top.document.body.clientWidth;
    thisY = window.top.document.body.clientHeight;

    xx = (thisX / 2) - (iWidth / 2)
    yy = (thisY / 2) - (iHeight / 2)

    var win = window.open(OpenFile, "ExcelMessageHelp", "left=10,top=10,width=" + iWidth + ",height=" + iHeight + ", scrollbars=no,menubar=no,resizable=yes");
    win.focus();
    
}

function excelSend_HelpClose()
{
    document.getElementById("Div_help").style.visibility = "hidden";
    document.getElementById("div_SmsGrid").style.visibility = "";
    document.getElementById("ib_SMSSend").style.visibility = "";
}

function AddrSelect(arr) {
    var k = 0, i;
    var iCnt = arr.length / 4;
    var Div_RecvNo = document.getElementById("Div_RecvNo");
    var retValue;
    
    if(Div_RecvNo != undefined)
    {
        while (k < iCnt) {
            i = k * 2;
            var v_UserName = arr[(i * 2) + 0].value;
            var v_FaxNo = arr[(i * 2) + 1].value;
            var v_MobileNo = arr[(i * 2) + 2].value;
            var v_ComName = arr[(i * 2) + 3].value;

            RecvNoAdd2(v_MobileNo, v_UserName, v_ComName);
            k++;
        }
    }
    else
    {
        var AXobj = document.getElementById("FlexGridReplace");
        var intRetValue;
        var item = "|E2FAX|";
        
        while(k < iCnt)
        {
            i = k * 2;
            var v_UserName = arr[(i * 2) + 0].value;
            var v_FaxNo = arr[(i * 2) + 1].value;
            var v_MobileNo = arr[(i * 2) + 2].value;
            var v_ComName = arr[(i * 2) + 3].value;
            
            retValue = IsMobileNo(v_MobileNo);
            
            if(retValue)
            {
                item += v_ComName + "::" + v_UserName + "::" +  v_MobileNo + "|^|";
            }
            else
            {
                alert("잘못된 휴대폰번호 입니다.[" + v_MobileNo + "]");
            }
            
            k++;
        }
        
        if (AXobj != undefined) {
            window.clipboardData.setData('Text', item);
            intRetValue = AXobj.AXAddrSend();
        }
    }
}

function SMSRecordDelete()
{
    var ReturnValue;
    
    conf = confirm("문자전송결과 기록 삭제는 문자발송이 완료(성공 또는 실패)된 문자만 삭제 됩니다. 또한, 삭제된 문자는 복구가 불가능 합니다.\n\n삭제 하시겠습니까?");
    if (conf) 
    {
        ActionFile = "AjaxSMS.aspx";
        DatatoSend = "JobFlag=RecordDelete&SearchBeginDate=" + sTop.HidBeginDate.value +"&SearchEndDate=" + sTop.HidEndDate.value +"&SearchValue=" + escape(sTop.HidSearchValue.value) +"&SearchText=" + escape(sTop.HidSearchText.value) +"&PageNo=" + sTop.HidPageNo.value +"&PageCount=" + sTop.HidPageCount.value +"";
        ReturnValue = GetXmlHTTP(ActionFile, DatatoSend);
        
        if (typeof ReturnValue != "undefined") 
        {
            if (ReturnValue == "1") 
            {
                alert("문자전송결과 기록이 삭제 되었습니다.");
                return true;
            }
            else if (ReturnValue == "100") 
            {
                alert("로그인 해주세요.");
            }
            else if (ReturnValue == "200") 
            {
                alert("문자전송결과를 먼저 조회해 주세요.");
            }
            else
            {
                alert("삭제 중 오류가 발생하였습니다.");
            }
        }
    }
    
    return false;
}

function SMSSendResultExcel() {
    var sUrl;
    var BeginDate, EndDate, SearchType, SearchValue;

    if (sTop.tBox_StartYear.value.length != 4) {
        alert("검색일자(년)을 4자리로 입력해 주세요.");
        sTop.tBox_StartYear.focus();
        return false;
    }
    if (sTop.tBox_StartMonth.value.length != 2) {
        alert("검색일자(월)을 입력해 주세요.\n\n입력 예) 04, 12");
        sTop.tBox_StartMonth.focus();
        return false;
    }
    if (sTop.tBox_StartDay.value.length != 2) {
        alert("검색일자(일)을 입력해 주세요.\n\n입력 예) 04, 12, 31");
        sTop.tBox_StartDay.focus();
        return false;
    }
    if (sTop.tBox_EndYear.value.length != 4) {
        alert("검색일자(년)을 4자리로 입력해 주세요.");
        sTop.tBox_EndYear.focus();
        return false;
    }
    if (sTop.tBox_EndMonth.value.length != 2) {
        alert("검색일자(월)을 입력해 주세요.\n\n입력 예) 04, 12");
        sTop.tBox_EndMonth.focus();
        return false;
    }
    if (sTop.tBox_EndDay.value.length != 2) {
        alert("검색일자(일)을 입력해 주세요.\n\n입력 예) 04, 12, 31");
        sTop.tBox_EndDay.focus();
        return false;
    }

    BeginDate = sTop.tBox_StartYear.value + sTop.tBox_StartMonth.value + sTop.tBox_StartDay.value;
    EndDate = sTop.tBox_EndYear.value + sTop.tBox_EndMonth.value + sTop.tBox_EndDay.value;
    SearchType = sTop.HidSearchText.value;
    SearchValue = sTop.HidSearchValue.value;

    if ((BeginDate.length != 8) && (EndDate.length != 8)) {
        alert("문자전송결과를 먼저 조회해 주세요.");
        return false;
    }

    sUrl = "SMSSendResultExcel.aspx?BeginDate=" + BeginDate + "&EndDate=" + EndDate + "&SearchType=" + SearchType + "&SearchValue=" + escape(SearchValue) + "&PageNo=" + sTop.HidPageNo.value + "&PageCount=" + sTop.HidPageCount.value;
    SMSSendResultExcelFrame.location.href = sUrl;

    return false;
}

function GoSMSSend() {
    location.href = "SMSSend.aspx";
}

function GoSMSSendResult() {
    location.href = "MessageSendList.aspx";
}

function SMSMessageBtnOver(BtnName) {
    var DivName, BtnID;
    var xx, yy;

    switch (BtnName) {
        case "UserName":
            DivName = "Div_UserName";
            BtnID = "SMSMessageBtn_UserName";
            xx = -84;
            yy = -30;
            break;
        case "ComName":
            DivName = "Div_ComName";
            BtnID = "SMSMessageBtn_ComName";
            xx = -84;
            yy = -58;
            break;
        case "SMSSave":
            DivName = "Div_SMSSave";
            BtnID = "SMSMessageBtn_SMSSave";
            xx = -86;
            yy = -30;
            break;
        case "SMSInput":
            DivName = "Div_SMSInput";
            BtnID = "SMSMessageBtn_SMSInput";
            xx = -86;
            yy = -58;
            break;
    }

    var Div = document.getElementById(DivName);

    if (Div.style.visibility == "hidden") {
        var tBoxPos = getBounds(document.getElementById(BtnID));

        Div.style.top = (tBoxPos.top + xx) + "px";
        Div.style.left = (tBoxPos.left + yy) + "px";
        Div.style.zIndex = "1";

        Div.style.visibility = "";
    } else {
        Div.style.visibility = "hidden";
    }
}

function SMSMessageBtnOut(BtnName) {
    var DivName, BtnID;

    switch (BtnName) {
        case "UserName":
            DivName = "Div_UserName";
            BtnID = "SMSMessageBtn_UserName";
            break;
        case "ComName":
            DivName = "Div_ComName";
            BtnID = "SMSMessageBtn_ComName";
            break;
        case "SMSSave":
            DivName = "Div_SMSSave";
            BtnID = "SMSMessageBtn_SMSSave";
            break;
        case "SMSInput":
            DivName = "Div_SMSInput";
            BtnID = "SMSMessageBtn_SMSInput";
            break;
    }

    var Div = document.getElementById(DivName);
    Div.style.visibility = "hidden";
}

function SMSSendResultAllCheck() {
    var chkvalue;

    if (sTop.cBox_SMSSendResultAllCheck.checked) {
        chkvalue = true;
    } else {
        chkvalue = false;
    }

    for (var i = 0; i < sTop.length; i++) {
        if (sTop.item(i).getAttribute("type") == "checkbox") {
            if (!sTop.item(i).disabled) {
                sTop.item(i).checked = chkvalue;
            }
        }
    }
}

function SMSSendResultSelectDataRemove() {
    var conf;
    var sUrl;
    var strSMSKey = "";
    var BeginDate, EndDate, SearchType, SearchValue;

    BeginDate = sTop.HidBeginDate.value;
    EndDate = sTop.HidEndDate.value;
    SearchType = sTop.ddl_SearchValue.value;
    SearchValue = sTop.tBox_SearchText.value;


    for (var i = 0; i < sTop.length; i++) {
        if (sTop.item(i).getAttribute("type") == "checkbox") {
            if (sTop.item(i).checked) {
                if (sTop.item(i).id != "cBox_SMSSendResultAllCheck") {
                    if (strSMSKey.length > 0)
                        strSMSKey += ";" + sTop.item(i).id;
                    else
                        strSMSKey = sTop.item(i).id;
                }
            }
        }
    }

    strSMSKey = Replace(strSMSKey, "SMSSendResult_", "");

    if (strSMSKey == "") {
        alert("삭제할 문자를 선택해 주세요.");
        return false;
    }

    conf = confirm("문자전송결과 삭제는 문자발송이 완료(성공 또는 실패)된 문자만 삭제 됩니다.\n\n삭제된 문자는 복구가 불가하오니 꼭 \"엑셀파일저장\"으로 백업 후 삭제하시기 바랍니다.\n\n선택한 문자를 삭제 하시겠습니까?");
    if (conf) {
        document.form1.pst_HidRemoveType.value = "SelectData";
        document.form1.pst_HidSelectSMSKeys.value = strSMSKey;
        document.form1.pst_HidBeginDate.value = BeginDate;
        document.form1.pst_HidEndDate.value = EndDate;
        document.form1.pst_HidSearchType.value = SearchType;
        document.form1.pst_HidSearchValue.value = SearchValue;
        document.form1.target = "SMSSendResultDataRemoveFrame";
        document.form1.action = "SMSSendResultRemove.aspx";
        document.form1.method = "post";
        document.form1.submit();
    }
    else {
        return false;
    }
}

function SMSSendResultDataRemove() {
    var conf;
    var sUrl;
    var BeginDate, EndDate, SearchType, SearchValue;

    BeginDate = sTop.HidBeginDate.value;
    EndDate = sTop.HidEndDate.value;
    SearchType = sTop.ddl_SearchValue.value;
    SearchValue = sTop.tBox_SearchText.value;

    if ((BeginDate.length != 8) && (EndDate.length != 8)) {
        alert("문자를 먼저 조회해 주세요.");
        return false;
    }

    conf = confirm("문자전송결과 삭제는 문자발송이 완료(성공 또는 실패)된 문자만 삭제 됩니다.\n\n삭제된 문자는 복구가 불가하오니 꼭 \"엑셀파일저장\"으로 백업 후 삭제하시기 바랍니다.\n\n조회된 전체 문자를 삭제 하시겠습니까?");
    if (conf) {
        document.form1.pst_HidRemoveType.value = "AllData";
        document.form1.pst_HidBeginDate.value = BeginDate;
        document.form1.pst_HidEndDate.value = EndDate;
        document.form1.pst_HidSearchType.value = SearchType;
        document.form1.pst_HidSearchValue.value = SearchValue;
        document.form1.target = "SMSSendResultDataRemoveFrame";
        document.form1.action = "SMSSendResultRemove.aspx";
        document.form1.method = "post";
        document.form1.submit();
    }

    return false;
}

function SMSNoticePopup() {

    var iWidth, iHeight, thisX, thisY, xx, yy;
    var winTop;
    var pop_cookie;

    winTop = parent;

    iWidth = 700;
    iHeight = 800;

    thisX = winTop.document.body.clientWidth;
    thisY = winTop.document.body.clientHeight;

    xx = (thisX / 2) - (iWidth / 2)
    yy = (thisY / 2) - (iHeight / 2)

    var win = window.open("../popup/popup20151013_banner.htm", "SMSBanner", "left=" + xx + ",top=" + yy + ",width=" + iWidth + ",height=" + iHeight + ", scrollbars=no,menubar=no,resizable=no");
    win.focus();

}

function SMSNoticeInit() {

    var iWidth, iHeight, thisX, thisY, xx, yy;
    var winTop;
    var pop_cookie;

    pop_cookie = "Bill36524SMSPopup";
    winTop = parent;

    iWidth = 700;
    iHeight = 830;

    thisX = winTop.document.body.clientWidth;
    thisY = winTop.document.body.clientHeight;

    xx = (thisX / 2) - (iWidth / 2)
    yy = (thisY / 2) - (iHeight / 2)

    if (getCookie(pop_cookie) != "done") {

        var win = window.open("../popup/popup20151013.htm", "popup20151013", "left=" + xx + ",top=" + yy + ",width=" + iWidth + ",height=" + iHeight + ", scrollbars=no,menubar=no,resizable=no");
        win.focus();
    }
}

function CallbackNoSystemView() {
    var iWidth, iHeight, thisX, thisY, xx, yy;
    var winTop;
    var pop_cookie;

    winTop = parent;

    iWidth = 368;
    iHeight = 490;

    thisX = winTop.document.body.clientWidth;
    thisY = winTop.document.body.clientHeight;

    xx = (thisX / 2) - (iWidth / 2)
    yy = (thisY / 2) - (iHeight / 2)

    var win = window.open("CallbackNo.aspx", "CallbackNoSystemView", "left=" + xx + ",top=" + yy + ",width=" + iWidth + ",height=" + iHeight + ", scrollbars=no,menubar=no,resizable=no");
    win.focus();
}

function CallbackNoInsert() {
    var sTop = document.all;
    var sValue = "";

    try {
        for (var i = 0; i < sTop.length; i++) {
            if (sTop.item(i).getAttribute("type") == "radio") {
                if (sTop.item(i).checked) {
                    if (typeof sTop.item(i).name != "undefined") {
                        sValue = Replace(sTop.item(i).value, "rBox_CallbackNo_", "");
                        break;
                    }
                }
            }
        }

        if (sValue != "") {
            opener.document.all.tBox_CallbackNo.value = sValue;
            self.window.close();
        }
        else {
            alert("선택된 발신번호가 없습니다.");
            return false;
        }
    }
    catch (e) {
    }
}

function CallbackNoSystemAdd() {
    var sURL = document.all.HidCallbackNoSystemURL.value + "?" + document.all.HidCallbackNoSystemGetData.value;    
    var iWidth, iHeight, thisX, thisY, xx, yy;
    var winTop;
    var pop_cookie;

    winTop = parent;

    iWidth = 800;
    iHeight = 700;

    thisX = screen.width;
    thisY = screen.height;

    xx = (thisX / 2) - (iWidth / 2)
    yy = (thisY / 2) - (iHeight / 2)

    var retValue = window.showModalDialog(sURL, "", "dialogWidth:" + iWidth + "px;dialogHeight:" + iHeight + "px;resizable:no;status:no;help:no;location:no;scroll:no");
    if (typeof ("undefined")) {
        location.href = "CallbackNo.aspx";
    }
}

function CallbackNoSystemClose() {
    self.window.close();
}

function ADSMSSendValidate() {
    var SMSMode;
    var AryRecvNo;
    var RecvNoCount;
    var RecvNoTopOne;
    var SendSummaryRecvNoText;
    var SendSummaryReservationText;
    var SendSummaryReservationValue;
    var ActionFile, DatatoSend, ReturnValue;
    var SendPosCode, SendMoney;
    var SendMoneyText;
    var JascSMSType;

    if ((escape(sTop.tBox_Msg.value) == TempMsg) || (escape(sTop.tBox_Msg.value) == LMSTempMsg) || (sTop.tBox_Msg.value == "")) {
        alert("보낼메시지를 입력하세요.");
        return false;
    }

    if (!DoCheckLang(sTop.tBox_Msg.value)) {
        return false;
    }

    AryRecvNo = GetRecvNo();
    if (AryRecvNo == "" || AryRecvNo == undefined) {
        alert("받을사람을 선택해 주세요.");
        return false;
    }

    if (AryRecvNo != "TextFile") {
        RecvNoCount = parseInt(AryRecvNo.split("‡").length);
        RecvNoTopOne = AryRecvNo.split("‡")[0].split("¶")[0];

        if (RecvNoCount > 1) {
            SendSummaryRecvNoText = RecvNoTopOne + "외 " + (RecvNoCount - 1).toString() + "건";
        }
        else {
            SendSummaryRecvNoText = RecvNoTopOne;
        }
    }
    else {
        RecvNoCount = Replace(document.getElementById("RecvNoCountText").innerHTML, ",", "");
        SendSummaryRecvNoText = "총 " + document.getElementById("RecvNoCountText").innerHTML + "건";
    }

    sTop.s_SendSummaryRecvNoText.value = SendSummaryRecvNoText;

    if (sTop.tBox_CallbackNo.value == "") {
        alert("발신번호를 입력해 주세요.");
        return false;
    }
    else {
        if (!IsCallbackNo(sTop.tBox_CallbackNo.value)) {
            alert("발신번호가 잘못 되었습니다.");
            return false;
        }
    }

    var ADTotalMsgLength = 0;
    var ADBottomMsgLength = 41;   //무료수신거부\n080-877-8208\n발신자코드42045
    var ADHeadMsgLength1 = parseInt(getByteLength("(광고)" + "\n" + document.all.HidLoginComName.value + "\n" + document.all.tBox_CallbackNo.value + "\n"));
    var ADHeadMsgLength2 = parseInt(getByteLength("(광고)" + "\n" + document.all.HidLoginComName.value + "\n"));
    var ADContentMsgLength = parseInt(document.getElementById("MsgLength").innerHTML) + 1;

    if (document.all.cBox_TelNoRefuse.checked)
        ADTotalMsgLength = parseInt(ADHeadMsgLength2) + parseInt(ADContentMsgLength) + parseInt(ADBottomMsgLength);
    else
        ADTotalMsgLength = parseInt(ADHeadMsgLength1) + parseInt(ADContentMsgLength) + parseInt(ADBottomMsgLength);

    if (parseInt(ADTotalMsgLength) <= 90) {
        SMSMode = "SMS";
    }
    else if (parseInt(ADTotalMsgLength) > 90) {
        SMSMode = "LMS";
    }

    if (parseInt(document.getElementById("MsgLength").outerText) <= parseInt(document.getElementById("Msg80").outerText)) {
        if (SMSMode == "LMS") {
            var confMode = confirm("장문으로 전환 됩니다. 계속 하시겠습니까?");
            if (!confMode) {
                return false;
            }
        }    
    }

    if (sTop.rBox_SendNow.checked) {
        SendSummaryReservationText = "즉시발송";
    } else {
        var yr = document.getElementById("ddl_ReserYear").options[document.getElementById("ddl_ReserYear").selectedIndex].value;
        var mo = document.getElementById("ddl_ReserMonth").options[document.getElementById("ddl_ReserMonth").selectedIndex].value;
        var dy = document.getElementById("ddl_ReserDay").options[document.getElementById("ddl_ReserDay").selectedIndex].value;
        var hu = document.getElementById("ddl_ReserHour").options[document.getElementById("ddl_ReserHour").selectedIndex].value;
        var mi = document.getElementById("ddl_ReserMinute").options[document.getElementById("ddl_ReserMinute").selectedIndex].value;

        if (mo.length == 1) mo = "0" + mo;
        if (dy.length == 1) dy = "0" + dy;
        if (hu.length == 1) hu = "0" + hu;
        if (mi.length == 1) mi = "0" + mi;

        SendSummaryReservationText = yr + "년 " + mo + "월 " + dy + "일 " + hu + "시 " + mi + "분";
        SendSummaryReservationValue = yr + mo + dy + hu + mi;
    }

    //SMS, LMS, MMS송신요금 반환
    ActionFile = "AjaxSMS.aspx";
    DatatoSend = "JobFlag=SetSMSSendPossible&SMSType=" + SMSMode + "&RecvNoCount=" + RecvNoCount.toString();
    ReturnValue = GetXmlHTTP(ActionFile, DatatoSend);

    if (typeof ReturnValue != "undefined") {
        var AryReturnValue = ReturnValue.split(";");
        if ((AryReturnValue[0] == "110") || (AryReturnValue[0] == "111") || (AryReturnValue[0] == "112") || (AryReturnValue[0] == "121") || (AryReturnValue[0] == "122")) {
            SendPosCode = AryReturnValue[0];
            SendMoney = AryReturnValue[1];

            if ((SendPosCode == "112") || (SendPosCode == "122")) {
                SendMoneyText = "무료포인트 " + add_comma(SendMoney) + "포인트";
            }
            else if (SendPosCode == "111") {
                SendMoneyText = "충전포인트 " + add_comma(SendMoney) + "포인트";
            }
            else if (SendPosCode == "121") {
                SendMoneyText = "후불제 " + add_comma(SendMoney) + "포인트";
            }
        }
        else if (ReturnValue == "100") {
            alert("로그인 해주세요.");
            return false;
        }
        else {
            alert("발송예상요금 확인 중 오류가 발생하였습니다.");
            return false;
        }
    }

    var strRefusalMsg = "무료수신거부\n080-877-8199\n발신자코드" + sTop.HidSendCode.value;
    var strADHeadMsg1 = "(광고)" + "\n" + document.all.HidLoginComName.value + "\n" + document.all.tBox_CallbackNo.value;
    var strADHeadMsg2 = "(광고)" + "\n" + document.all.HidLoginComName.value;

    if (SendPosCode != "110") {
        if (sTop.JascSMSType.value != "AD") {
            document.all.tBox_SummaryMsg.value = sTop.tBox_Msg.value;
        } else {
            if (document.all.cBox_TelNoRefuse.checked) {
                document.all.tBox_SummaryMsg.value = strADHeadMsg2 + "\n" + sTop.tBox_Msg.value + "\n" + strRefusalMsg;
            }
            else {
                document.all.tBox_SummaryMsg.value = strADHeadMsg1 + "\n" + sTop.tBox_Msg.value + "\n" + strRefusalMsg;
            }
        }
        document.getElementById("Div_SendSummary_CallbackNo").innerHTML = sTop.tBox_CallbackNo.value;
        document.getElementById("Div_SendSummary_RecvNo").innerHTML = SendSummaryRecvNoText;
        document.getElementById("Div_SendSummary_SendReservation").innerHTML = SendSummaryReservationText;
        document.getElementById("Div_SendSummary_RecvNoCount").innerHTML = add_comma(RecvNoCount.toString()) + "건";
        document.getElementById("Div_SendSummary_SendMoney").innerHTML = SendMoneyText;

        SendSummaryOpen();
    }
    else {
        alert("포인트가 부족합니다.");
        return false;
    }

    sTop.s_SMSMode.value = SMSMode;
    sTop.s_Msg.value = sTop.tBox_Msg.value;
    sTop.s_Subject.value = sTop.tBox_Subject.value;
    sTop.s_RecvNo.value = AryRecvNo;

    if (sTop.cBox_Overlaping.checked) {
        sTop.s_IsOverlap.value = "on";
    }
    else {
        sTop.s_IsOverlap.value = "off";
    }

    sTop.s_CallbackNo.value = sTop.tBox_CallbackNo.value;

    if (sTop.rBox_SendNow.checked) {
        sTop.s_SendReservation.value = "now";
    } else {
        sTop.s_SendReservation.value = SendSummaryReservationValue;
    }

    return false;
}

function TelNoCheck() {
    if (sTop.cBox_TelNoRefuse.checked) {
        sTop.cBox_TelNoRefuse.checked = false;
    }
    else {
        sTop.cBox_TelNoRefuse.checked = true;
    }
}

function getByteLength(msg) {
    var nbytes = 0;
    for (i = 0; i < msg.length; i++) {
        var ch = msg.charAt(i);
        if (escape(ch).length > 4) {
            nbytes += 2;
        } else if (ch == '\n') {
            if (msg.charAt(i - 1) != '\r') {
                nbytes += 1;
            }
        } else if (ch == '<' || ch == '>') {
            nbytes += 4;
        } else {
            nbytes += 1;
        }
    }
    return nbytes;
}

function RemoveCallbackNoSystem(CallbackNoView, CallbackNo) {
    var conf;
    var ActionFile, DatatoSend, ReturnValue;

    if (CallbackNo.length > 0) {
        conf = confirm("발신번호 [" + CallbackNoView + "]를 삭제 하시겠습니까?");
        if (conf) {
            ActionFile = "../WebFax/AjaxSMS.aspx";
            DatatoSend = "JobFlag=RemoveCallbackNoSystem&CallbackNo=" + CallbackNo;
            ReturnValue = GetXmlHTTP(ActionFile, DatatoSend);
            
            if (ReturnValue == "1") {
                alert("발신번호가 삭제 되었습니다.");
            }
            else {
                alert("발신번호 삭제 중 오류가 발생하였습니다.");
            }

            location.href = "CallbackNo.aspx";
        }
    }
}

function CallbackNoNoticePopup() {

    var iWidth, iHeight, thisX, thisY, xx, yy;
    var winTop;
    var pop_cookie;

    pop_cookie = "popup20151229";
    winTop = opener;

    iWidth = 766;
    iHeight = 820;

    if (getCookie(pop_cookie) != "done") {

        var win = window.open("../popup/popup20151229.htm", "popup20151229", "left=0,top=0,width=" + iWidth + ",height=" + iHeight + ", scrollbars=no,menubar=no,resizable=no");
        win.focus();
    }
}
